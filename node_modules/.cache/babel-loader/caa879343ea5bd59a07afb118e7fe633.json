{"ast":null,"code":"var _jsxFileName = \"C:\\\\dev\\\\New folder\\\\rg\\\\src\\\\components\\\\buildPage\\\\EditBuildPage.js\";\nimport React, { useContext } from 'react';\nimport HeroTalents from '../heroTalents/HeroTalents';\nimport Inventory from '../inventory/Inventory';\nimport './EditBuildPage.css';\nimport HeroDetails from '../heroDetails/HeroDetails';\nimport { Tab, Tabs, TabList, TabPanel } from 'react-tabs';\nimport \"react-tabs/style/react-tabs.css\";\nimport BuildOptions from './BuildOptions';\nimport BuildSummary from './BuildSummary';\nimport { AppContext } from '../../stores/Store';\nimport HeroSelect from '../heroSelect/HeroSelect';\nimport { useParams, useRouteMatch } from 'react-router';\nimport { auth, db, firebase } from '../../utils/Firebase';\nimport * as Constants from '../../data/Constants';\nimport history from '../../utils/History';\nimport { UserContext } from '../../stores/UserStore';\nimport { Link } from 'react-router-dom';\nimport BuildInformation from './BuildInformation';\n\nfunction EditBuildPage() {\n  const [state, updateState] = useContext(AppContext);\n  const userState = useContext(UserContext);\n  const {\n    path\n  } = useRouteMatch();\n  var paths = path.split('/');\n  var currentPath = paths[paths.length - 1];\n  console.log('current path ' + currentPath);\n\n  if (currentPath === 'edit') {\n    if (state.readonly) {\n      updateState({\n        type: \"UPDATE_READONLY\",\n        payload: false\n      });\n    }\n  } else if (currentPath === 'view') {\n    if (!state.readonly) {\n      updateState({\n        type: \"UPDATE_READONLY\",\n        payload: true\n      });\n    }\n  } else if (currentPath === 'create') {\n    if (!state.createBuild) {\n      updateState({\n        type: \"UPDATE_CREATE_BUILD_STATE\",\n        payload: true\n      });\n    }\n  }\n\n  let params = useParams();\n  console.log(!userState.userId);\n  console.log('params build id: ' + params.buildId);\n  var root = document.getElementById('root');\n  root.dataset.pageName = 'editBuildPage';\n\n  if (params.buildId && state.buildId !== params.buildId) {\n    loadBuild(params.buildId);\n  }\n\n  function loadBuild(buildId) {\n    console.log('loading build id ' + buildId);\n\n    if (state.buildId !== buildId) {\n      state.buildId = buildId;\n    }\n\n    db.collection('builds').doc(buildId).get().then(build => {\n      if (!build.data()) {\n        console.log('No build found with ID ' + buildId); //history.push('/build/create');\n        //update state to indicate no build available in DB\n\n        return;\n      }\n\n      console.log('build loaded from db:');\n      console.log(build.data());\n      updateState({\n        type: 'INIT_STATE_FROM_DATA',\n        payload: build\n      });\n    }).catch(error => {\n      console.error('Error retrieving data from DB:', error);\n    });\n  }\n\n  function handleDescriptionChanged(e) {\n    updateState({\n      type: \"UPDATE_DESCRIPTION\",\n      payload: e.currentTarget.value\n    });\n  }\n\n  function handleNameChange(e) {\n    updateState({\n      type: \"UPDATE_NAME\",\n      payload: e.currentTarget.value\n    });\n  }\n\n  function saveBuildClick() {\n    if (!auth.currentUser) {\n      alert('Can\\'t save or create builds when not authenticated.');\n      return;\n    }\n\n    if (!state.dirty) {\n      console.log('Not saving build, no changes have been made.');\n      return;\n    }\n\n    console.log('saving build to database build id ' + state.buildId + ' for user id ' + auth.currentUser.uid);\n\n    if (state.buildId === 0) {\n      createBuild();\n    } else {\n      saveBuild();\n    }\n  }\n\n  function decrementWeaponStat(careerStat, weaponId, property1Id, property2Id, traitId) {\n    let oldWeaponIndex = careerStat.weapons.findIndex(item => {\n      return item.id === weaponId;\n    });\n    let oldWeapon = careerStat.weapons[oldWeaponIndex];\n    decrementStat(oldWeapon.properties, property1Id);\n    decrementStat(oldWeapon.properties, property2Id);\n    decrementStat(oldWeapon.traits, traitId);\n    /*             decrementProperty(oldWeapon, weaponId, property1Id);\r\n                decrementProperty(oldWeapon, weaponId, property2Id);\r\n                decrementTrait(oldWeapon, weaponId, traitId); */\n\n    /*             let oldWeaponProperty1Index = oldWeapon.properties.findIndex((item) => { return item.id === property1Id;});\r\n                let oldWeaponProperty2Index = oldWeapon.properties.findIndex((item) => { return item.id === property2Id;});\r\n                let oldWeaponTraitIndex = oldWeapon.traits.findIndex((item) => { return item.id === traitId;});\r\n    \r\n                let oldWeaponProperty1 = oldWeapon.properties[oldWeaponProperty1Index];\r\n                let oldWeaponProperty2 = oldWeapon.properties[oldWeaponProperty2Index];\r\n                let oldWeaponTrait = oldWeapon.traits[oldWeaponTraitIndex];\r\n    \r\n                oldWeaponProperty1.count -= 1;\r\n                oldWeaponProperty2.count -= 1;\r\n                oldWeaponTrait.count -= 1;\r\n    \r\n                console.log(oldWeapon.properties[oldWeaponProperty1Index]);\r\n                console.log(oldWeaponProperty1);\r\n    \r\n                oldWeapon.properties[oldWeaponProperty1Index] = oldWeaponProperty1;\r\n                oldWeapon.properties[oldWeaponProperty2Index] = oldWeaponProperty2;\r\n                oldWeapon.traits[oldWeaponTraitIndex] = oldWeaponTrait; */\n\n    oldWeapon.count -= 1;\n    careerStat.weapons[oldWeaponIndex] = oldWeapon;\n  }\n\n  function decrementProperty(propertyStats, propertyId) {\n    let propertyIndex = propertyStats.findIndex(item => {\n      return item.id === propertyId;\n    });\n    propertyStats[propertyIndex].count--;\n    /*             propertyStat.count -= 1;\r\n    \r\n                propertyStats[statIndex] = propertyStat; */\n  }\n\n  function decrementStat(stats, statId) {\n    adjustStat(stats, statId, -1);\n  }\n\n  function incrementStat(stats, statId) {\n    adjustStat(stats, statId, 1);\n  }\n\n  function adjustStat(stats, statId, adjustmentValue) {\n    let statIndex = stats.findIndex(item => {\n      return item.id === statId;\n    });\n    stats[statIndex].count = stats[statIndex].count + adjustmentValue;\n  }\n  /*         function decrementTrait(stats, id, traitId) {\r\n              let statIndex = stats.findIndex((item) => { return item.id === id;});\r\n              let stat = stats[statIndex];\r\n  \r\n              let traitIndex = stat.traits.findIndex((item) => { return item.id === traitId;});\r\n              let traitStat = stat.traits[traitIndex];\r\n  \r\n              traitStat.count -= 1;\r\n  \r\n              stat.traits[traitIndex] = traitStat;\r\n  \r\n              stats[statIndex] = stat;\r\n          } */\n\n\n  function decrementNecklaceStat(careerStat, property1Id, property2Id, traitId) {\n    let necklaceProperty1Index = careerStat.necklace.properties.findIndex(property => {\n      return property.id === property1Id;\n    });\n    let necklaceProperty2Index = careerStat.necklace.properties.findIndex(property => {\n      return property.id === property2Id;\n    });\n    let necklaceTraitIndex = careerStat.necklace.traits.findIndex(trait => {\n      return trait.id === traitId;\n    });\n    let necklaceProperty1 = careerStat.necklace.properties[necklaceProperty1Index];\n    let necklaceProperty2 = careerStat.necklace.properties[necklaceProperty2Index];\n    let necklaceTrait = careerStat.necklace.traits[necklaceTraitIndex];\n    necklaceProperty1.count -= 1;\n    necklaceProperty2.count -= 1;\n    necklaceTrait.count -= 1;\n    careerStat.necklace.properties[necklaceProperty1Index] = necklaceProperty1;\n    careerStat.necklace.properties[necklaceProperty2Index] = necklaceProperty2;\n    careerStat.necklace.traits[necklaceTraitIndex] = necklaceTrait;\n  }\n\n  function decrementCharmStat(careerStat, property1Id, property2Id, traitId) {\n    let charmProperty1Index = careerStat.charm.properties.findIndex(property => {\n      return property.id === property1Id;\n    });\n    let charmProperty2Index = careerStat.charm.properties.findIndex(property => {\n      return property.id === property2Id;\n    });\n    let charmTraitIndex = careerStat.charm.traits.findIndex(trait => {\n      return trait.id === traitId;\n    });\n    let charmProperty1 = careerStat.charm.properties[charmProperty1Index];\n    let charmProperty2 = careerStat.charm.properties[charmProperty2Index];\n    let charmTrait = careerStat.charm.traits[charmTraitIndex];\n    charmProperty1.count -= 1;\n    charmProperty2.count -= 1;\n    charmTrait.count -= 1;\n    careerStat.charm.properties[charmProperty1Index] = charmProperty1;\n    careerStat.charm.properties[charmProperty2Index] = charmProperty2;\n    careerStat.charm.traits[charmTraitIndex] = charmTrait;\n  }\n\n  function decrementTrinketStat(careerStat, property1Id, property2Id, traitId) {\n    let trinketProperty1Index = careerStat.trinket.properties.findIndex(property => {\n      return property.id === property1Id;\n    });\n    let trinketProperty2Index = careerStat.trinket.properties.findIndex(property => {\n      return property.id === property2Id;\n    });\n    let trinketTraitIndex = careerStat.trinket.traits.findIndex(trait => {\n      return trait.id === traitId;\n    });\n    let trinketProperty1 = careerStat.trinket.properties[trinketProperty1Index];\n    let trinketProperty2 = careerStat.trinket.properties[trinketProperty2Index];\n    let trinketTrait = careerStat.trinket.traits[trinketTraitIndex];\n    trinketProperty1.count -= 1;\n    trinketProperty2.count -= 1;\n    trinketTrait.count -= 1;\n    careerStat.trinket.properties[trinketProperty1Index] = trinketProperty1;\n    careerStat.trinket.properties[trinketProperty2Index] = trinketProperty2;\n    careerStat.trinket.traits[trinketTraitIndex] = trinketTrait;\n  }\n\n  function isCareerOrGearChanged(build) {\n    return !(state.careerId === build.data().careerId && state.primaryWeaponId === build.data().primaryWeapon.id && state.secondaryWeaponId === build.data().secondaryWeapon.id && state.properties[Constants.PRIMARY_PROPERTY1_INDEX] === build.data().primaryWeapon.property1Id && state.properties[Constants.PRIMARY_PROPERTY2_INDEX] === build.data().primaryWeapon.property2Id && state.properties[Constants.SECONDARY_PROPERTY1_INDEX] === build.data().secondaryWeapon.property1Id && state.properties[Constants.SECONDARY_PROPERTY2_INDEX] === build.data().secondaryWeapon.property2Id && state.properties[Constants.NECKLACE_PROPERTY1_INDEX] === build.data().necklace.property1Id && state.properties[Constants.NECKLACE_PROPERTY2_INDEX] === build.data().necklace.property2Id && state.properties[Constants.CHARM_PROPERTY1_INDEX] === build.data().charm.property1Id && state.properties[Constants.CHARM_PROPERTY2_INDEX] === build.data().charm.property2Id && state.properties[Constants.TRINKET_PROPERTY1_INDEX] === build.data().trinket.property1Id && state.properties[Constants.TRINKET_PROPERTY2_INDEX] === build.data().trinket.property2Id && state.traits[Constants.PRIMARY_TRAIT_INDEX] === build.data().primaryWeapon.trait && state.traits[Constants.SECONDARY_TRAIT_INDEX] === build.data().secondaryWeapon.trait && state.traits[Constants.NECKLACE_TRAIT_INDEX] === build.data().necklace.trait && state.traits[Constants.CHARM_TRAIT_INDEX] === build.data().charm.trait && state.traits[Constants.TRINKET_TRAIT_INDEX] === build.data().trinket.trait);\n  }\n\n  function updateBuildAndStats() {\n    let buildStatsRef = db.collection('builds').doc('stats');\n    let buildRef = db.collection('builds').doc(state.buildId);\n    db.runTransaction(transaction => {\n      return transaction.getAll(buildStatsRef, buildRef).then(querySnapshot => {\n        if (!querySnapshot || querySnapshot.size < 2) {\n          console.log('Could not find stats and build document');\n          return;\n        }\n\n        let buildStats = querySnapshot.docs[0];\n        let build = querySnapshot.docs[1];\n        let careers = buildStats.data().careers;\n        let newCareerIndex = careers.findIndex(career => {\n          return career.id === state.careerId;\n        });\n        let newCareerStat = careers[newCareerIndex];\n        let oldCareerIndex = careers.findIndex(career => {\n          return career.id === build.data().careerId;\n        });\n        let oldCareerStat = careers[oldCareerIndex]; // PREPARE BUILD STATS\n\n        if (isCareerOrGearChanged(build)) {\n          //build equipment or career has changed, update stats in addition to saving changes\n          if (state.careerId !== build.data().careerId) {\n            // Career changed, decrement all stats from old career, increment all in new career\n            if (!newCareerStat) {\n              newCareerStat = {\n                id: state.careerId,\n                count: 0,\n                weapons: [],\n                necklace: {\n                  properties: [],\n                  traits: []\n                },\n                charm: {\n                  properties: [],\n                  traits: []\n                },\n                trinket: {\n                  properties: [],\n                  traits: []\n                }\n              };\n            }\n\n            newCareerStat.count += 1;\n            oldCareerStat.count -= 1;\n            decrementWeaponStat(oldCareerStat, build.data().primaryWeapon.id, build.data().primaryWeapon.property1Id, build.data().primaryWeapon.property2Id, build.data().primaryWeapon.traitId);\n            decrementWeaponStat(oldCareerStat, build.data().secondayWeapon.id, build.data().secondayWeapon.property1Id, build.data().secondayWeapon.property2Id, build.data().secondayWeapon.traitId);\n            decrementNecklaceStat(oldCareerStat, build.data().necklace.property1Id, build.data().necklace.property2Id, build.data().necklace.traitId);\n            decrementCharmStat(oldCareerStat, build.data().charm.property1Id, build.data().charm.property2Id, build.data().charm.traitId);\n            decrementTrinketStat(oldCareerStat, build.data().trinket.property1Id, build.data().trinket.property2Id, build.data().trinket.traitId);\n            incrementWeaponStat(newCareerStat, state.primaryWeaponId, state.properties[Constants.PRIMARY_PROPERTY1_INDEX], state.properties[Constants.PRIMARY_PROPERTY2_INDEX], state.properties[Constants.PRIMARY_TRAIT_INDEX]);\n            incrementWeaponStat(newCareerStat, state.secondaryWeaponId, state.properties[Constants.SECONDARY_PROPERTY1_INDEX], state.properties[Constants.SECONDARY_PROPERTY2_INDEX], state.properties[Constants.SECONDARY_TRAIT_INDEX]);\n            incrementNecklaceStat(newCareerStat, state.properties[Constants.NECKLACE_PROPERTY1_INDEX], state.properties[Constants.NECKLACE_PROPERTY2_INDEX], state.properties[Constants.NECKLACE_TRAIT_INDEX]);\n            incrementCharmStat(newCareerStat, state.properties[Constants.CHARM_PROPERTY1_INDEX], state.properties[Constants.CHARM_PROPERTY2_INDEX], state.properties[Constants.CHARM_TRAIT_INDEX]);\n            incrementTrinketStat(newCareerStat, state.properties[Constants.TRINKET_PROPERTY1_INDEX], state.properties[Constants.TRINKET_PROPERTY2_INDEX], state.properties[Constants.TRINKET_TRAIT_INDEX]);\n          } else {\n            // Check properties and traits of each weapon and gear item and increment/decrement where necessary\n            if (state.primaryWeaponId !== build.data().primaryWeapon.id) {\n              decrementWeaponStat(oldCareerStat, build.data().primaryWeapon.id, build.data().primaryWeapon.property1Id, build.data().primaryWeapon.property2Id, build.data().primaryWeapon.traitId);\n              incrementWeaponStat(newCareerStat, state.primaryWeaponId, state.properties[Constants.PRIMARY_PROPERTY1_INDEX], state.properties[Constants.PRIMARY_PROPERTY2_INDEX], state.properties[Constants.PRIMARY_TRAIT_INDEX]);\n            } else {\n              // Weapon is the same as before, only adjust properties/traits\n              let weaponIndex = oldCareerStat.weapons.findIndex(item => {\n                return item.id === build.data().primaryWeapon.id;\n              });\n              let weapon = oldCareerStat.weapons[weaponIndex]; //check if properties or trait changed\n\n              if (state.properties[Constants.PRIMARY_PROPERTY1_INDEX] !== build.data().primaryWeapon.property1Id) {\n                // decrement property\n                decrementStat(weapon.properties, build.data().primaryWeapon.property1Id);\n                incrementStat(weapon.properties, state.properties[Constants.PRIMARY_PROPERTY1_INDEX]);\n              }\n\n              if (state.properties[Constants.PRIMARY_PROPERTY2_INDEX] !== build.data().primaryWeapon.property2Id) {\n                // decrement property\n                decrementStat(weapon.properties, build.data().primaryWeapon.property2Id);\n                incrementStat(weapon.properties, state.properties[Constants.PRIMARY_PROPERTY2_INDEX]);\n              }\n\n              if (state.traits[Constants.PRIMARY_TRAIT_INDEX] !== build.data().primaryWeapon.traitId) {\n                // decrement trait\n                decrementStat(weapon.traits, build.data().primaryWeapon.traitId);\n                incrementStat(weapon.traits, state.traits[Constants.PRIMARY_TRAIT_INDEX]);\n              }\n            }\n\n            if (state.secondaryWeaponId !== build.data().secondaryWeapon.id) {\n              decrementWeaponStat(oldCareerStat, build.data().secondayWeapon.id, build.data().secondayWeapon.property1Id, build.data().secondayWeapon.property2Id, build.data().secondayWeapon.traitId);\n              incrementWeaponStat(newCareerStat, state.secondaryWeaponId, state.properties[Constants.SECONDARY_PROPERTY1_INDEX], state.properties[Constants.SECONDARY_PROPERTY2_INDEX], state.properties[Constants.SECONDARY_TRAIT_INDEX]);\n            } else {\n              // Weapon is the same as before, only adjust properties/traits\n              let weaponIndex = oldCareerStat.weapons.findIndex(item => {\n                return item.id === build.data().secondaryWeapon.id;\n              });\n              let weapon = oldCareerStat.weapons[weaponIndex]; //check if properties or trait changed\n\n              if (state.properties[Constants.SECONDARY_PROPERTY1_INDEX] !== build.data().secondaryWeapon.property1Id) {\n                // decrement property\n                decrementStat(weapon.properties, build.data().secondaryWeapon.property1Id);\n                incrementStat(weapon.properties, state.properties[Constants.SECONDARY_PROPERTY1_INDEX]);\n              }\n\n              if (state.properties[Constants.SECONDARY_PROPERTY2_INDEX] !== build.data().secondaryWeapon.property2Id) {\n                // decrement property\n                decrementStat(weapon.properties, build.data().secondaryWeapon.property2Id);\n                incrementStat(weapon.properties, state.properties[Constants.SECONDARY_PROPERTY2_INDEX]);\n              }\n\n              if (state.traits[Constants.SECONDARY_TRAIT_INDEX] !== build.data().secondaryWeapon.traitId) {\n                // decrement trait\n                decrementStat(weapon.traits, build.data().secondaryWeapon.traitId);\n                incrementStat(weapon.traits, state.traits[Constants.SECONDARY_TRAIT_INDEX]);\n              }\n            } // REPEAT this for each property and trait\n\n\n            if (state.properties[Constants.NECKLACE_PROPERTY1_INDEX] !== build.data().necklace.property1Id) {\n              // decrement property\n              decrementStat(weapon.properties, build.data().necklace.property1Id);\n              incrementStat(weapon.properties, state.properties[Constants.NECKLACE_PROPERTY1_INDEX]);\n            }\n\n            if (state.properties[Constants.NECKLACE_PROPERTY2_INDEX] !== build.data().necklace.property2Id) {\n              // decrement property\n              decrementStat(weapon.properties, build.data().necklace.property2Id);\n              incrementStat(weapon.properties, state.properties[Constants.NECKLACE_PROPERTY2_INDEX]);\n            }\n\n            if (state.traits[Constants.NECKLACE_TRAIT_INDEX] !== build.data().necklace.traitId) {\n              // decrement trait\n              decrementStat(weapon.traits, build.data().necklace.traitId);\n              incrementStat(weapon.traits, state.traits[Constants.NECKLACE_TRAIT_INDEX]);\n            }\n\n            if (state.properties[Constants.CHARM_PROPERTY1_INDEX] !== build.data().charm.property1Id) {\n              // decrement property\n              decrementStat(weapon.properties, build.data().charm.property1Id);\n              incrementStat(weapon.properties, state.properties[Constants.CHARM_PROPERTY1_INDEX]);\n            }\n\n            if (state.properties[Constants.CHARM_PROPERTY2_INDEX] !== build.data().charm.property2Id) {\n              // decrement property\n              decrementStat(weapon.properties, build.data().charm.property2Id);\n              incrementStat(weapon.properties, state.properties[Constants.CHARM_PROPERTY2_INDEX]);\n            }\n\n            if (state.traits[Constants.CHARM_TRAIT_INDEX] !== build.data().charm.traitId) {\n              // decrement trait\n              decrementStat(weapon.traits, build.data().charm.traitId);\n              incrementStat(weapon.traits, state.traits[Constants.CHARM_TRAIT_INDEX]);\n            }\n\n            if (state.properties[Constants.TRINKET_PROPERTY1_INDEX] !== build.data().trinket.property1Id) {\n              // decrement property\n              decrementStat(weapon.properties, build.data().trinket.property1Id);\n              incrementStat(weapon.properties, state.properties[Constants.TRINKET_PROPERTY1_INDEX]);\n            }\n\n            if (state.properties[Constants.TRINKET_PROPERTY2_INDEX] !== build.data().trinket.property2Id) {\n              // decrement property\n              decrementStat(weapon.properties, build.data().trinket.property2Id);\n              incrementStat(weapon.properties, state.properties[Constants.TRINKET_PROPERTY2_INDEX]);\n            }\n\n            if (state.traits[Constants.TRINKET_TRAIT_INDEX] !== build.data().trinket.traitId) {\n              // decrement trait\n              decrementStat(weapon.traits, build.data().trinket.traitId);\n              incrementStat(weapon.traits, state.traits[Constants.TRINKET_TRAIT_INDEX]);\n            }\n          }\n        }\n        /* \r\n                            let newPrimaryWeapon = newCareerStat.weapons ? newCareerStat.weapons.find((weapon) => {return weapon.id === state.primaryWeaponId;}) : null;\r\n                            let oldPrimaryWeapon = null\r\n        \r\n                            if (!newPrimaryWeapon) {\r\n                                newPrimaryWeapon = {\r\n                                    id: state.primaryWeaponId,\r\n                                    count: 0,\r\n                                    properties: [],\r\n                                    traits: []\r\n                                }\r\n                            }\r\n                            \r\n                            if (state.primaryWeaponId !== build.data().primaryWeaponId) {\r\n        \r\n                            }\r\n        \r\n                            newPrimaryWeapon.count += 1;\r\n        \r\n                            var newProperty1 = newPrimaryWeapon.properties ? newPrimaryWeapon.properties.find((property) => {return property.id === state.properties[Constants.PRIMARY_PROPERTY1_INDEX];}) : null;\r\n        \r\n                            if (!newProperty1) {\r\n                                newProperty1 = {\r\n                                    id: state.properties[Constants.PRIMARY_PROPERTY1_INDEX],\r\n                                    count: 0\r\n                                }\r\n                            }\r\n        \r\n                            newProperty1.count += 1;\r\n        \r\n                            var newProperty2 = newPrimaryWeapon.properties ? newPrimaryWeapon.properties.find((property) => {return property.id === state.properties[Constants.PRIMARY_PROPERTY2_INDEX];}) : null;\r\n        \r\n                            if (!newProperty2) {\r\n                                newProperty2 = {\r\n                                    id: state.properties[Constants.PRIMARY_PROPERTY2_INDEX],\r\n                                    count: 0\r\n                                }\r\n                            }\r\n        \r\n                            newProperty2.count += 1;\r\n        \r\n                            var newTrait = newPrimaryWeapon.traits ? newPrimaryWeapon.traits.find((trait) => {return trait.id === state.traits[Constants.PRIMARY_TRAIT_INDEX];}) : null;\r\n        \r\n                            if (!newTrait) {\r\n                                newTrait = {\r\n                                    id: state.properties[Constants.PRIMARY_PROPERTY2_INDEX],\r\n                                    count: 0\r\n                                }\r\n                            }\r\n        \r\n                            newTrait.count += 1;\r\n        \r\n                            var newTraitIndex = newPrimaryWeapon.traits ? newPrimaryWeapon.traits.findIndex((trait) => { return trait.id === newTrait.id}) : -1;\r\n                            if (newTraitIndex < 0) {\r\n                                newPrimaryWeapon.traits ? newPrimaryWeapon.traits.push(newTrait) : newPrimaryWeapon.traits = [newTrait];\r\n                            }\r\n                            else {\r\n                                newPrimaryWeapon.traits[newTraitIndex] = newTrait;\r\n                            }\r\n        \r\n                            var newProperty1Index = newPrimaryWeapon.properties ? newPrimaryWeapon.properties.findIndex((property) => { return property.id === newProperty1.id}) : -1;\r\n                            if (newProperty1Index < 0) {\r\n                                newPrimaryWeapon.properties ? newPrimaryWeapon.properties.push(newProperty1) : newPrimaryWeapon.properties = [newProperty1];\r\n                            }\r\n                            else {\r\n                                newPrimaryWeapon.properties[newProperty1Index] = newProperty1;\r\n                            }\r\n        \r\n                            var newProperty2Index = newPrimaryWeapon.properties ? newPrimaryWeapon.properties.findIndex((property) => { return property.id === newProperty2.id}) : -1;\r\n                            if (newProperty2Index < 0) {\r\n                                newPrimaryWeapon.properties ? newPrimaryWeapon.properties.push(newProperty2) : newPrimaryWeapon.properties = [newProperty2];\r\n                            }\r\n                            else {\r\n                                newPrimaryWeapon.properties[newProperty2Index] = newProperty2;\r\n                            }\r\n        \r\n                            var newPrimaryWeaponIndex = newCareerStat.weapons ? newCareerStat.weapons.findIndex((weapon) => { return weapon.id === newPrimaryWeapon.id}) : -1;\r\n                            if (newPrimaryWeaponIndex < 0) {\r\n                                newCareerStat.weapons ? newCareerStat.weapons.push(newPrimaryWeapon) : newCareerStat.weapons = [newPrimaryWeapon];\r\n                            }\r\n                            else {\r\n                                newCareerStat.weapons[newPrimaryWeaponIndex] = newPrimaryWeapon;\r\n                            }\r\n        \r\n                            var newCareerStatIndex = careers ? careers.findIndex((career) => { return career.id === newCareerStat.id}) : -1;\r\n                            if (newCareerStatIndex < 0) {\r\n                                careers ? careers.push(newCareerStat) : careers = [newCareerStat];\r\n                            }\r\n                            else {\r\n                                careers[newCareerStatIndex] = newCareerStat;\r\n                            } */\n\n\n        careers[oldCareerIndex] = oldCareerStat;\n        careers[newCareerIndex] = newCareerStat;\n        transaction.update(buildStatsRef, {\n          careers: careers\n        });\n      });\n    }).then(() => {\n      console.log('successfully updated stats');\n    });\n  }\n\n  function createBuild() {\n    console.log('Creating new build.');\n    let increment = 1; //firebase.firestore.FieldValue.increment(1);\n\n    let batch = db.batch();\n    let buildStatsRef = db.collection('builds').doc('stats');\n    db.runTransaction(transaction => {\n      return transaction.get(buildStatsRef).then(buildStats => {\n        if (!buildStats) {\n          console.log('No stats document found');\n          return;\n        }\n\n        console.log(buildStats.data());\n        var careers = buildStats.data().careers;\n        var newCareerStat = careers.find(career => {\n          return career.id === state.careerId;\n        });\n        console.log(newCareerStat);\n\n        if (!newCareerStat) {\n          newCareerStat = {\n            id: state.careerId,\n            count: 0,\n            weapons: []\n          };\n        }\n\n        newCareerStat.count += 1;\n        var newPrimaryWeapon = newCareerStat.weapons ? newCareerStat.weapons.find(weapon => {\n          return weapon.id === state.primaryWeaponId;\n        }) : null;\n\n        if (!newPrimaryWeapon) {\n          newPrimaryWeapon = {\n            id: state.primaryWeaponId,\n            count: 0,\n            properties: [],\n            traits: []\n          };\n        }\n\n        newPrimaryWeapon.count += 1;\n        var newProperty1 = newPrimaryWeapon.properties ? newPrimaryWeapon.properties.find(property => {\n          return property.id === state.properties[Constants.PRIMARY_PROPERTY1_INDEX];\n        }) : null;\n\n        if (!newProperty1) {\n          newProperty1 = {\n            id: state.properties[Constants.PRIMARY_PROPERTY1_INDEX],\n            count: 0\n          };\n        }\n\n        newProperty1.count += 1;\n        var newProperty2 = newPrimaryWeapon.properties ? newPrimaryWeapon.properties.find(property => {\n          return property.id === state.properties[Constants.PRIMARY_PROPERTY2_INDEX];\n        }) : null;\n\n        if (!newProperty2) {\n          newProperty2 = {\n            id: state.properties[Constants.PRIMARY_PROPERTY2_INDEX],\n            count: 0\n          };\n        }\n\n        newProperty2.count += 1;\n        var newTrait = newPrimaryWeapon.traits ? newPrimaryWeapon.traits.find(trait => {\n          return trait.id === state.traits[Constants.PRIMARY_TRAIT_INDEX];\n        }) : null;\n\n        if (!newTrait) {\n          newTrait = {\n            id: state.properties[Constants.PRIMARY_PROPERTY2_INDEX],\n            count: 0\n          };\n        }\n\n        newTrait.count += 1;\n        var newTraitIndex = newPrimaryWeapon.traits ? newPrimaryWeapon.traits.findIndex(trait => {\n          return trait.id === newTrait.id;\n        }) : -1;\n\n        if (newTraitIndex < 0) {\n          newPrimaryWeapon.traits ? newPrimaryWeapon.traits.push(newTrait) : newPrimaryWeapon.traits = [newTrait];\n        } else {\n          newPrimaryWeapon.traits[newTraitIndex] = newTrait;\n        }\n\n        var newProperty1Index = newPrimaryWeapon.properties ? newPrimaryWeapon.properties.findIndex(property => {\n          return property.id === newProperty1.id;\n        }) : -1;\n\n        if (newProperty1Index < 0) {\n          newPrimaryWeapon.properties ? newPrimaryWeapon.properties.push(newProperty1) : newPrimaryWeapon.properties = [newProperty1];\n        } else {\n          newPrimaryWeapon.properties[newProperty1Index] = newProperty1;\n        }\n\n        var newProperty2Index = newPrimaryWeapon.properties ? newPrimaryWeapon.properties.findIndex(property => {\n          return property.id === newProperty2.id;\n        }) : -1;\n\n        if (newProperty2Index < 0) {\n          newPrimaryWeapon.properties ? newPrimaryWeapon.properties.push(newProperty2) : newPrimaryWeapon.properties = [newProperty2];\n        } else {\n          newPrimaryWeapon.properties[newProperty2Index] = newProperty2;\n        }\n\n        var newPrimaryWeaponIndex = newCareerStat.weapons ? newCareerStat.weapons.findIndex(weapon => {\n          return weapon.id === newPrimaryWeapon.id;\n        }) : -1;\n\n        if (newPrimaryWeaponIndex < 0) {\n          newCareerStat.weapons ? newCareerStat.weapons.push(newPrimaryWeapon) : newCareerStat.weapons = [newPrimaryWeapon];\n        } else {\n          newCareerStat.weapons[newPrimaryWeaponIndex] = newPrimaryWeapon;\n        }\n\n        var newCareerStatIndex = careers ? careers.findIndex(career => {\n          return career.id === newCareerStat.id;\n        }) : -1;\n\n        if (newCareerStatIndex < 0) {\n          careers ? careers.push(newCareerStat) : careers = [newCareerStat];\n        } else {\n          careers[newCareerStatIndex] = newCareerStat;\n        }\n\n        transaction.update(buildStatsRef, {\n          careers: careers\n        });\n        transaction.set(db.collection('builds').doc(), {\n          careerId: state.careerId,\n          primaryWeapon: {\n            id: state.primaryWeaponId,\n            property1Id: state.properties[Constants.PRIMARY_PROPERTY1_INDEX],\n            property2Id: state.properties[Constants.PRIMARY_PROPERTY2_INDEX],\n            traitId: state.traits[Constants.PRIMARY_TRAIT_INDEX]\n          },\n          secondaryWeapon: {\n            id: state.secondaryWeaponId,\n            property1Id: state.properties[Constants.SECONDARY_PROPERTY1_INDEX],\n            property2Id: state.properties[Constants.SECONDARY_PROPERTY2_INDEX],\n            traitId: state.traits[Constants.SECONDARY_TRAIT_INDEX]\n          },\n          necklace: {\n            property1Id: state.properties[Constants.NECKLACE_PROPERTY1_INDEX],\n            property2Id: state.properties[Constants.NECKLACE_PROPERTY2_INDEX],\n            traitId: state.traits[Constants.NECKLACE_TRAIT_INDEX]\n          },\n          charm: {\n            property1Id: state.properties[Constants.CHARM_PROPERTY1_INDEX],\n            property2Id: state.properties[Constants.CHARM_PROPERTY2_INDEX],\n            traitId: state.traits[Constants.CHARM_TRAIT_INDEX]\n          },\n          trinket: {\n            property1Id: state.properties[Constants.TRINKET_PROPERTY1_INDEX],\n            property2Id: state.properties[Constants.TRINKET_PROPERTY2_INDEX],\n            traitId: state.traits[Constants.TRINKET_TRAIT_INDEX]\n          },\n          talent1: state.talents[Constants.TALENT_TIER_1],\n          talent2: state.talents[Constants.TALENT_TIER_2],\n          talent3: state.talents[Constants.TALENT_TIER_3],\n          talent4: state.talents[Constants.TALENT_TIER_4],\n          talent5: state.talents[Constants.TALENT_TIER_5],\n          talent6: state.talents[Constants.TALENT_TIER_6],\n          name: state.name,\n          description: state.description,\n          difficulties: state.difficulties.map(item => {\n            return item.id;\n          }),\n          missions: state.missions.map(item => {\n            return item.id;\n          }),\n          potions: state.potions.map(item => {\n            return item.id;\n          }),\n          roles: state.roles.map(item => {\n            return item.id;\n          }),\n          books: state.books.map(item => {\n            return item.id;\n          }),\n          likeCount: 0,\n          dateCreated: new Date(),\n          dateModified: new Date(),\n          userId: auth.currentUser.uid,\n          username: auth.currentUser.displayName,\n          videos: state.videos,\n          isDeleted: false\n        });\n      });\n    }).then(() => {\n      console.log('successfully updated stats');\n    });\n    /*             batch.set(db.collection('builds').doc(), {\r\n                    careerId: state.careerId,                    \r\n                    primaryWeapon: {\r\n                        id: state.primaryWeaponId,\r\n                        property1Id: state.properties[Constants.PRIMARY_PROPERTY1_INDEX],\r\n                        property2Id: state.properties[Constants.PRIMARY_PROPERTY2_INDEX],\r\n                        traitId: state.traits[Constants.PRIMARY_TRAIT_INDEX]\r\n                    },\r\n                    secondaryWeapon: {\r\n                        id: state.secondaryWeaponId,\r\n                        property1Id: state.properties[Constants.SECONDARY_PROPERTY1_INDEX],\r\n                        property2Id: state.properties[Constants.SECONDARY_PROPERTY2_INDEX],\r\n                        traitId: state.traits[Constants.SECONDARY_TRAIT_INDEX]\r\n                    },\r\n                    necklace: {\r\n                        property1Id: state.properties[Constants.NECKLACE_PROPERTY1_INDEX],\r\n                        property2Id: state.properties[Constants.NECKLACE_PROPERTY2_INDEX],\r\n                        traitId: state.traits[Constants.NECKLACE_TRAIT_INDEX]\r\n                    },\r\n                    charm: {\r\n                        property1Id: state.properties[Constants.CHARM_PROPERTY1_INDEX],\r\n                        property2Id: state.properties[Constants.CHARM_PROPERTY2_INDEX],\r\n                        traitId: state.traits[Constants.CHARM_TRAIT_INDEX]\r\n                    },\r\n                    trinket: {\r\n                        property1Id: state.properties[Constants.TRINKET_PROPERTY1_INDEX],\r\n                        property2Id: state.properties[Constants.TRINKET_PROPERTY2_INDEX],\r\n                        traitId: state.traits[Constants.TRINKET_TRAIT_INDEX]\r\n                    },\r\n                    talent1: state.talents[Constants.TALENT_TIER_1],\r\n                    talent2: state.talents[Constants.TALENT_TIER_2],\r\n                    talent3: state.talents[Constants.TALENT_TIER_3],\r\n                    talent4: state.talents[Constants.TALENT_TIER_4],\r\n                    talent5: state.talents[Constants.TALENT_TIER_5],\r\n                    talent6: state.talents[Constants.TALENT_TIER_6],\r\n                    name: state.name,\r\n                    description: state.description,\r\n                    difficulties: state.difficulties.map((item) => { return item.id }),\r\n                    missions: state.missions.map((item) => { return item.id }),\r\n                    potions: state.potions.map((item) => { return item.id }),\r\n                    roles: state.roles.map((item) => { return item.id }),\r\n                    books: state.books.map((item) => { return item.id }),\r\n                    likeCount: 0,\r\n                    dateCreated: new Date(),\r\n                    dateModified: new Date(),\r\n                    userId: auth.currentUser.uid,\r\n                    username: auth.currentUser.displayName,\r\n                    videos: state.videos,\r\n                    isDeleted: false\r\n                });\r\n                batch.commit(); */\n\n    /*             db.collection('builds').doc('stats').set({\r\n                    careers: [\r\n                        {\r\n                            id: state.careerId,\r\n                            count: increment,\r\n                            weapons: [\r\n                                {\r\n                                    id: state.primaryWeaponId,\r\n                                    count: increment,\r\n                                    properties: [\r\n                                        {\r\n                                            id: state.properties[Constants.PRIMARY_PROPERTY1_INDEX],\r\n                                            count: increment\r\n                                        },\r\n                                        {\r\n                                            id: state.properties[Constants.PRIMARY_PROPERTY2_INDEX],\r\n                                            count: increment\r\n                                        }\r\n                                    ],\r\n                                    traits: [\r\n                                        {\r\n                                            id: state.traits[Constants.PRIMARY_TRAIT_INDEX],\r\n                                            count: increment\r\n                                        }\r\n                                    ]\r\n                                },\r\n                                {\r\n                                    id: state.secondaryWeaponId,\r\n                                    count: increment,\r\n                                    properties: [\r\n                                        {\r\n                                            id: state.properties[Constants.SECONDARY_PROPERTY1_INDEX],\r\n                                            count: increment\r\n                                        },\r\n                                        {\r\n                                            id: state.properties[Constants.SECONDARY_PROPERTY2_INDEX],\r\n                                            count: increment\r\n                                        }\r\n                                    ],\r\n                                    traits: [\r\n                                        {\r\n                                            id: state.traits[Constants.SECONDARY_TRAIT_INDEX],\r\n                                            count: increment\r\n                                        }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        }\r\n                    ]\r\n                }); */\n\n    /*             db.collection('builds').add({\r\n                    careerId: state.careerId,                    \r\n                    primaryWeapon: {\r\n                        id: state.primaryWeaponId,\r\n                        property1Id: state.properties[Constants.PRIMARY_PROPERTY1_INDEX],\r\n                        property2Id: state.properties[Constants.PRIMARY_PROPERTY2_INDEX],\r\n                        traitId: state.traits[Constants.PRIMARY_TRAIT_INDEX]\r\n                    },\r\n                    secondaryWeapon: {\r\n                        id: state.secondaryWeaponId,\r\n                        property1Id: state.properties[Constants.SECONDARY_PROPERTY1_INDEX],\r\n                        property2Id: state.properties[Constants.SECONDARY_PROPERTY2_INDEX],\r\n                        traitId: state.traits[Constants.SECONDARY_TRAIT_INDEX]\r\n                    },\r\n                    necklace: {\r\n                        property1Id: state.properties[Constants.NECKLACE_PROPERTY1_INDEX],\r\n                        property2Id: state.properties[Constants.NECKLACE_PROPERTY2_INDEX],\r\n                        traitId: state.traits[Constants.NECKLACE_TRAIT_INDEX]\r\n                    },\r\n                    charm: {\r\n                        property1Id: state.properties[Constants.CHARM_PROPERTY1_INDEX],\r\n                        property2Id: state.properties[Constants.CHARM_PROPERTY2_INDEX],\r\n                        traitId: state.traits[Constants.CHARM_TRAIT_INDEX]\r\n                    },\r\n                    trinket: {\r\n                        property1Id: state.properties[Constants.TRINKET_PROPERTY1_INDEX],\r\n                        property2Id: state.properties[Constants.TRINKET_PROPERTY2_INDEX],\r\n                        traitId: state.traits[Constants.TRINKET_TRAIT_INDEX]\r\n                    },\r\n                    talent1: state.talents[Constants.TALENT_TIER_1],\r\n                    talent2: state.talents[Constants.TALENT_TIER_2],\r\n                    talent3: state.talents[Constants.TALENT_TIER_3],\r\n                    talent4: state.talents[Constants.TALENT_TIER_4],\r\n                    talent5: state.talents[Constants.TALENT_TIER_5],\r\n                    talent6: state.talents[Constants.TALENT_TIER_6],\r\n                    name: state.name,\r\n                    description: state.description,\r\n                    difficulties: state.difficulties,\r\n                    missions: state.missions,\r\n                    potions: state.potions,\r\n                    roles: state.roles,\r\n                    books: state.books,\r\n                    likeCount: 0,\r\n                    dateCreated: new Date(),\r\n                    dateModified: new Date(),\r\n                    userId: auth.currentUser.uid,\r\n                    username: auth.currentUser.displayName,\r\n                    videos: state.videos,\r\n                    isDeleted: false\r\n                }).then((docRef) => {\r\n                    console.log(\"Document written with ID: \", docRef.id);\r\n                    history.push('/build/' + docRef.id + '/edit');\r\n    \r\n                    //redirect to build edit page here\r\n    \r\n                }).catch((error) => {\r\n                    console.error(\"Error adding document: \", error);\r\n                }); */\n  }\n\n  function saveBuild() {\n    console.log('updating build, current state:');\n    console.log(state);\n\n    if (state.userId !== auth.currentUser.uid) {\n      alert('You can\\'t edit a build you didn\\'t create.');\n      return;\n    }\n\n    let buildDataRef = db.collection('builds').doc(state.buildId);\n    buildDataRef.set({\n      careerId: state.careerId,\n      primaryWeapon: {\n        id: state.primaryWeaponId,\n        property1Id: state.properties[Constants.PRIMARY_PROPERTY1_INDEX],\n        property2Id: state.properties[Constants.PRIMARY_PROPERTY2_INDEX],\n        traitId: state.traits[Constants.PRIMARY_TRAIT_INDEX]\n      },\n      secondaryWeapon: {\n        id: state.secondaryWeaponId,\n        property1Id: state.properties[Constants.SECONDARY_PROPERTY1_INDEX],\n        property2Id: state.properties[Constants.SECONDARY_PROPERTY2_INDEX],\n        traitId: state.traits[Constants.SECONDARY_TRAIT_INDEX]\n      },\n      necklace: {\n        property1Id: state.properties[Constants.NECKLACE_PROPERTY1_INDEX],\n        property2Id: state.properties[Constants.NECKLACE_PROPERTY2_INDEX],\n        traitId: state.traits[Constants.NECKLACE_TRAIT_INDEX]\n      },\n      charm: {\n        property1Id: state.properties[Constants.CHARM_PROPERTY1_INDEX],\n        property2Id: state.properties[Constants.CHARM_PROPERTY2_INDEX],\n        traitId: state.traits[Constants.CHARM_TRAIT_INDEX]\n      },\n      trinket: {\n        property1Id: state.properties[Constants.TRINKET_PROPERTY1_INDEX],\n        property2Id: state.properties[Constants.TRINKET_PROPERTY2_INDEX],\n        traitId: state.traits[Constants.TRINKET_TRAIT_INDEX]\n      },\n\n      /*                     primaryWeaponId: state.primaryWeaponId,\r\n                      primaryWeaponProperty1: state.properties[Constants.PRIMARY_PROPERTY1_INDEX],\r\n                      primaryWeaponProperty2:state.properties[Constants.PRIMARY_PROPERTY2_INDEX],\r\n                      primaryWeaponTrait: state.traits[Constants.PRIMARY_TRAIT_INDEX],\r\n                      secondaryWeaponId: state.secondaryWeaponId,\r\n                      secondaryWeaponProperty1: state.properties[Constants.SECONDARY_PROPERTY1_INDEX],\r\n                      secondaryWeaponProperty2: state.properties[Constants.SECONDARY_PROPERTY2_INDEX],\r\n                      secondaryWeaponTrait: state.traits[Constants.SECONDARY_TRAIT_INDEX],\r\n                      necklaceProperty1: state.properties[Constants.NECKLACE_PROPERTY1_INDEX],\r\n                      necklaceProperty2: state.properties[Constants.NECKLACE_PROPERTY2_INDEX],\r\n                      necklaceTrait: state.traits[Constants.NECKLACE_TRAIT_INDEX],\r\n                      charmProperty1: state.properties[Constants.CHARM_PROPERTY1_INDEX],\r\n                      charmProperty2: state.properties[Constants.CHARM_PROPERTY2_INDEX],\r\n                      charmTrait: state.traits[Constants.CHARM_TRAIT_INDEX],\r\n                      trinketProperty1: state.properties[Constants.TRINKET_PROPERTY1_INDEX],\r\n                      trinketProperty2: state.properties[Constants.TRINKET_PROPERTY2_INDEX],\r\n                      trinketTrait: state.traits[Constants.TRINKET_TRAIT_INDEX], */\n      talent1: state.talents[Constants.TALENT_TIER_1],\n      talent2: state.talents[Constants.TALENT_TIER_2],\n      talent3: state.talents[Constants.TALENT_TIER_3],\n      talent4: state.talents[Constants.TALENT_TIER_4],\n      talent5: state.talents[Constants.TALENT_TIER_5],\n      talent6: state.talents[Constants.TALENT_TIER_6],\n      name: state.name,\n      description: state.description,\n      difficulties: state.difficulties.map(item => {\n        return item.id;\n      }),\n      missions: state.missions.map(item => {\n        return item.id;\n      }),\n      potions: state.potions.map(item => {\n        return item.id;\n      }),\n      roles: state.roles.map(item => {\n        return item.id;\n      }),\n      books: state.books.map(item => {\n        return item.id;\n      }),\n      dateModified: new Date(),\n      //userId: auth.currentUser.uid,\n      //username: auth.currentUser.displayName,\n      //TODO - ensure that username is updated for each build when user edits their username\n      videos: state.videos,\n      isDeleted: false\n    }, {\n      merge: true\n    }).then(() => {\n      console.log(\"Document updated with ID: \", state.buildId);\n      updateState({\n        type: \"UPDATE_DIRTY\",\n        payload: false\n      });\n      var buildSaveIndicator = document.getElementById('buildSaveIndicator');\n      buildSaveIndicator.classList.add('saved');\n      setTimeout(() => {\n        buildSaveIndicator.classList.remove('saved');\n      }, 4000);\n    }).catch(error => {\n      console.error(\"Error updating document: \", error);\n    });\n  } //get build id param\n  //if empty, load nothing from DB\n  //if not empty, load build from DB and updatestate\n  //saving builds with /create/ url saves new db item and redirects to /buildId/edit page\n  //saving builds with /edit/ url just updates the record in the db\n\n\n  if (!state.isFromDb && !state.createBuild) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"edit-build-page\",\n      \"data-readonly\": state.readonly,\n      \"data-dirty\": state.dirty,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 991,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 992,\n        columnNumber: 21\n      }\n    }, \"No build found\"));\n  }\n\n  if (!auth.currentUser) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"edit-build-page\",\n      \"data-readonly\": state.readonly,\n      \"data-dirty\": state.dirty,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 998,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 999,\n        columnNumber: 21\n      }\n    }, \"You must be logged in to edit builds\"));\n  }\n\n  if (!state.createBuild && state.userId !== auth.currentUser.uid) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"edit-build-page\",\n      \"data-readonly\": state.readonly,\n      \"data-dirty\": state.dirty,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1005,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1006,\n        columnNumber: 21\n      }\n    }, \"Cannot edit build that you didn't create\"));\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"edit-build-page build-page\",\n    \"data-liked\": state.isLiked,\n    \"data-readonly\": state.readonly,\n    \"data-dirty\": state.dirty,\n    \"data-fresh\": state.createBuild,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1011,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    id: \"buildSaveIndicator\",\n    className: \"border-03 background-18\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1012,\n      columnNumber: 17\n    }\n  }, \"Build saved...\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"build-left-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1013,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"build-buttons-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1014,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    id: \"saveBuildButton\",\n    className: \"button-01 border-04\",\n    onClick: saveBuildClick.bind(this),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1015,\n      columnNumber: 25\n    }\n  }, \"Save Build\")), /*#__PURE__*/React.createElement(HeroSelect, {\n    careerId: state.careerId,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1017,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"build-main-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1019,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Tabs, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1020,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(TabList, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1021,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Tab, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1022,\n      columnNumber: 29\n    }\n  }, \"Summary\"), /*#__PURE__*/React.createElement(Tab, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1023,\n      columnNumber: 29\n    }\n  }, \"Videos\"), /*#__PURE__*/React.createElement(Tab, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1024,\n      columnNumber: 29\n    }\n  }, \"Combos\")), /*#__PURE__*/React.createElement(TabPanel, {\n    className: \"build-summary-tab\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1026,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"build-details-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1027,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(HeroDetails, {\n    careerId: state.careerId,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1028,\n      columnNumber: 33\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    className: \"build-name-input border-02 background-18\",\n    placeholder: \"Name your build\",\n    value: state.name,\n    onChange: handleNameChange.bind(this),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1029,\n      columnNumber: 33\n    }\n  }), /*#__PURE__*/React.createElement(\"textarea\", {\n    className: \"input-build-description border-02 background-18\",\n    wrap: \"hard\",\n    placeholder: \"Describe your build\",\n    value: state.description,\n    onChange: handleDescriptionChanged.bind(this),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1030,\n      columnNumber: 33\n    }\n  }), /*#__PURE__*/React.createElement(BuildInformation, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1031,\n      columnNumber: 33\n    }\n  }), /*#__PURE__*/React.createElement(BuildOptions, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1032,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(BuildSummary, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1034,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(TabPanel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1036,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"build-additional-info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1037,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(TabPanel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1040,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"hero-abilities\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1041,\n      columnNumber: 29\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"build-talents-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1045,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(HeroTalents, {\n    contextActionType: \"UPDATE_TALENTS\",\n    careerId: state.careerId,\n    talents: state.talents,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1046,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"build-right-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1049,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Inventory, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1050,\n      columnNumber: 21\n    }\n  })));\n}\n\nexport default EditBuildPage;","map":{"version":3,"sources":["C:/dev/New folder/rg/src/components/buildPage/EditBuildPage.js"],"names":["React","useContext","HeroTalents","Inventory","HeroDetails","Tab","Tabs","TabList","TabPanel","BuildOptions","BuildSummary","AppContext","HeroSelect","useParams","useRouteMatch","auth","db","firebase","Constants","history","UserContext","Link","BuildInformation","EditBuildPage","state","updateState","userState","path","paths","split","currentPath","length","console","log","readonly","type","payload","createBuild","params","userId","buildId","root","document","getElementById","dataset","pageName","loadBuild","collection","doc","get","then","build","data","catch","error","handleDescriptionChanged","e","currentTarget","value","handleNameChange","saveBuildClick","currentUser","alert","dirty","uid","saveBuild","decrementWeaponStat","careerStat","weaponId","property1Id","property2Id","traitId","oldWeaponIndex","weapons","findIndex","item","id","oldWeapon","decrementStat","properties","traits","count","decrementProperty","propertyStats","propertyId","propertyIndex","stats","statId","adjustStat","incrementStat","adjustmentValue","statIndex","decrementNecklaceStat","necklaceProperty1Index","necklace","property","necklaceProperty2Index","necklaceTraitIndex","trait","necklaceProperty1","necklaceProperty2","necklaceTrait","decrementCharmStat","charmProperty1Index","charm","charmProperty2Index","charmTraitIndex","charmProperty1","charmProperty2","charmTrait","decrementTrinketStat","trinketProperty1Index","trinket","trinketProperty2Index","trinketTraitIndex","trinketProperty1","trinketProperty2","trinketTrait","isCareerOrGearChanged","careerId","primaryWeaponId","primaryWeapon","secondaryWeaponId","secondaryWeapon","PRIMARY_PROPERTY1_INDEX","PRIMARY_PROPERTY2_INDEX","SECONDARY_PROPERTY1_INDEX","SECONDARY_PROPERTY2_INDEX","NECKLACE_PROPERTY1_INDEX","NECKLACE_PROPERTY2_INDEX","CHARM_PROPERTY1_INDEX","CHARM_PROPERTY2_INDEX","TRINKET_PROPERTY1_INDEX","TRINKET_PROPERTY2_INDEX","PRIMARY_TRAIT_INDEX","SECONDARY_TRAIT_INDEX","NECKLACE_TRAIT_INDEX","CHARM_TRAIT_INDEX","TRINKET_TRAIT_INDEX","updateBuildAndStats","buildStatsRef","buildRef","runTransaction","transaction","getAll","querySnapshot","size","buildStats","docs","careers","newCareerIndex","career","newCareerStat","oldCareerIndex","oldCareerStat","secondayWeapon","incrementWeaponStat","incrementNecklaceStat","incrementCharmStat","incrementTrinketStat","weaponIndex","weapon","update","increment","batch","find","newPrimaryWeapon","newProperty1","newProperty2","newTrait","newTraitIndex","push","newProperty1Index","newProperty2Index","newPrimaryWeaponIndex","newCareerStatIndex","set","talent1","talents","TALENT_TIER_1","talent2","TALENT_TIER_2","talent3","TALENT_TIER_3","talent4","TALENT_TIER_4","talent5","TALENT_TIER_5","talent6","TALENT_TIER_6","name","description","difficulties","map","missions","potions","roles","books","likeCount","dateCreated","Date","dateModified","username","displayName","videos","isDeleted","buildDataRef","merge","buildSaveIndicator","classList","add","setTimeout","remove","isFromDb","isLiked","bind"],"mappings":"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","sourcesContent":["import React, {useContext} from 'react';\r\nimport HeroTalents from '../heroTalents/HeroTalents'\r\nimport Inventory from '../inventory/Inventory'\r\nimport './EditBuildPage.css';\r\nimport HeroDetails from '../heroDetails/HeroDetails';\r\nimport { Tab, Tabs, TabList, TabPanel } from 'react-tabs';\r\nimport \"react-tabs/style/react-tabs.css\";\r\nimport BuildOptions from './BuildOptions';\r\nimport BuildSummary from './BuildSummary';\r\nimport { AppContext } from '../../stores/Store';\r\nimport HeroSelect from '../heroSelect/HeroSelect';\r\nimport { useParams, useRouteMatch } from 'react-router';\r\nimport { auth, db, firebase } from '../../utils/Firebase';\r\nimport * as Constants from '../../data/Constants';\r\nimport history from '../../utils/History';\r\nimport { UserContext } from '../../stores/UserStore';\r\nimport { Link } from 'react-router-dom';\r\nimport BuildInformation from './BuildInformation';\r\n\r\nfunction EditBuildPage() {\r\n\r\n        const [state, updateState] = useContext(AppContext);\r\n        const userState = useContext(UserContext);\r\n\r\n        const { path } = useRouteMatch();\r\n        var paths = path.split('/');\r\n\r\n        var currentPath = paths[paths.length-1];\r\n        console.log('current path ' + currentPath);\r\n\r\n        if (currentPath === 'edit') {\r\n            if (state.readonly) {\r\n                updateState({\r\n                    type: \"UPDATE_READONLY\", \r\n                    payload: false\r\n                });\r\n            }\r\n        } \r\n        else if (currentPath === 'view') {\r\n            if (!state.readonly) {\r\n                updateState({\r\n                    type: \"UPDATE_READONLY\", \r\n                    payload: true\r\n                });\r\n            }\r\n        }\r\n        else if (currentPath === 'create') {\r\n            if (!state.createBuild) {\r\n                updateState({\r\n                    type: \"UPDATE_CREATE_BUILD_STATE\",\r\n                    payload: true\r\n                });\r\n            }\r\n        }\r\n\r\n        let params = useParams();\r\n\r\n        console.log(!userState.userId);\r\n        console.log('params build id: ' + params.buildId);\r\n\r\n        var root = document.getElementById('root');\r\n        root.dataset.pageName = 'editBuildPage';\r\n\r\n        if (params.buildId && state.buildId !== params.buildId) {\r\n            loadBuild(params.buildId);\r\n        }\r\n\r\n        function loadBuild(buildId) {\r\n            console.log('loading build id ' + buildId);\r\n            if (state.buildId !== buildId) {\r\n                state.buildId = buildId;\r\n            }\r\n\r\n            db.collection('builds').doc(buildId).get().then((build) => {\r\n                if (!build.data()) {\r\n                    console.log('No build found with ID ' + buildId);\r\n                    //history.push('/build/create');\r\n\r\n                    //update state to indicate no build available in DB\r\n                    return;\r\n                }\r\n\r\n                console.log('build loaded from db:');\r\n                console.log(build.data());\r\n\r\n                updateState({\r\n                    type: 'INIT_STATE_FROM_DATA', \r\n                    payload: build\r\n                });\r\n            }).catch((error) => {\r\n                console.error('Error retrieving data from DB:', error);\r\n            });\r\n\r\n        }\r\n\r\n        function handleDescriptionChanged(e) {\r\n            updateState({\r\n                type: \"UPDATE_DESCRIPTION\", \r\n                payload: e.currentTarget.value\r\n            });\r\n        }\r\n\r\n        function handleNameChange(e) {\r\n            updateState({\r\n                type: \"UPDATE_NAME\", \r\n                payload: e.currentTarget.value\r\n            });\r\n        }\r\n\r\n        function saveBuildClick() {\r\n            \r\n            if (!auth.currentUser) {\r\n                alert('Can\\'t save or create builds when not authenticated.');\r\n                return;\r\n            }\r\n\r\n            if (!state.dirty) {\r\n                console.log('Not saving build, no changes have been made.');\r\n                return;\r\n            }\r\n\r\n            console.log('saving build to database build id ' + state.buildId + ' for user id ' + auth.currentUser.uid);\r\n\r\n            if (state.buildId === 0) {\r\n                createBuild();\r\n            }\r\n            else {\r\n                saveBuild();\r\n            }\r\n        }\r\n\r\n        function decrementWeaponStat(careerStat, weaponId, property1Id, property2Id, traitId) {\r\n\r\n            let oldWeaponIndex = careerStat.weapons.findIndex((item) => { return item.id === weaponId;});\r\n            let oldWeapon = careerStat.weapons[oldWeaponIndex];\r\n\r\n            decrementStat(oldWeapon.properties, property1Id);\r\n            decrementStat(oldWeapon.properties, property2Id);\r\n            decrementStat(oldWeapon.traits, traitId);\r\n\r\n/*             decrementProperty(oldWeapon, weaponId, property1Id);\r\n            decrementProperty(oldWeapon, weaponId, property2Id);\r\n            decrementTrait(oldWeapon, weaponId, traitId); */\r\n\r\n/*             let oldWeaponProperty1Index = oldWeapon.properties.findIndex((item) => { return item.id === property1Id;});\r\n            let oldWeaponProperty2Index = oldWeapon.properties.findIndex((item) => { return item.id === property2Id;});\r\n            let oldWeaponTraitIndex = oldWeapon.traits.findIndex((item) => { return item.id === traitId;});\r\n\r\n            let oldWeaponProperty1 = oldWeapon.properties[oldWeaponProperty1Index];\r\n            let oldWeaponProperty2 = oldWeapon.properties[oldWeaponProperty2Index];\r\n            let oldWeaponTrait = oldWeapon.traits[oldWeaponTraitIndex];\r\n\r\n            oldWeaponProperty1.count -= 1;\r\n            oldWeaponProperty2.count -= 1;\r\n            oldWeaponTrait.count -= 1;\r\n\r\n            console.log(oldWeapon.properties[oldWeaponProperty1Index]);\r\n            console.log(oldWeaponProperty1);\r\n\r\n            oldWeapon.properties[oldWeaponProperty1Index] = oldWeaponProperty1;\r\n            oldWeapon.properties[oldWeaponProperty2Index] = oldWeaponProperty2;\r\n            oldWeapon.traits[oldWeaponTraitIndex] = oldWeaponTrait; */\r\n\r\n            oldWeapon.count -= 1;\r\n            careerStat.weapons[oldWeaponIndex] = oldWeapon;\r\n        }\r\n\r\n        function decrementProperty(propertyStats, propertyId) {\r\n            let propertyIndex = propertyStats.findIndex((item) => { return item.id === propertyId;});\r\n            propertyStats[propertyIndex].count--;\r\n\r\n/*             propertyStat.count -= 1;\r\n\r\n            propertyStats[statIndex] = propertyStat; */\r\n        }\r\n        \r\n\r\n        function decrementStat(stats, statId) {\r\n            adjustStat(stats, statId, -1);\r\n        }\r\n\r\n        function incrementStat(stats, statId) {\r\n            adjustStat(stats, statId, 1);\r\n        }\r\n\r\n        function adjustStat(stats, statId, adjustmentValue) {\r\n            let statIndex = stats.findIndex((item) => { return item.id === statId;});\r\n            stats[statIndex].count = stats[statIndex].count + adjustmentValue;\r\n        }\r\n        \r\n\r\n/*         function decrementTrait(stats, id, traitId) {\r\n            let statIndex = stats.findIndex((item) => { return item.id === id;});\r\n            let stat = stats[statIndex];\r\n\r\n            let traitIndex = stat.traits.findIndex((item) => { return item.id === traitId;});\r\n            let traitStat = stat.traits[traitIndex];\r\n\r\n            traitStat.count -= 1;\r\n\r\n            stat.traits[traitIndex] = traitStat;\r\n\r\n            stats[statIndex] = stat;\r\n        } */\r\n\r\n        function decrementNecklaceStat(careerStat, property1Id, property2Id, traitId) {\r\n            let necklaceProperty1Index = careerStat.necklace.properties.findIndex((property) => {return property.id === property1Id;});\r\n            let necklaceProperty2Index = careerStat.necklace.properties.findIndex((property) => {return property.id === property2Id;});\r\n            let necklaceTraitIndex = careerStat.necklace.traits.findIndex((trait) => {return trait.id === traitId;});                        \r\n\r\n            let necklaceProperty1 = careerStat.necklace.properties[necklaceProperty1Index];\r\n            let necklaceProperty2 = careerStat.necklace.properties[necklaceProperty2Index];\r\n            let necklaceTrait = careerStat.necklace.traits[necklaceTraitIndex];\r\n\r\n            necklaceProperty1.count -= 1;\r\n            necklaceProperty2.count -= 1;\r\n            necklaceTrait.count -= 1;\r\n\r\n            careerStat.necklace.properties[necklaceProperty1Index] = necklaceProperty1;\r\n            careerStat.necklace.properties[necklaceProperty2Index] = necklaceProperty2;\r\n            careerStat.necklace.traits[necklaceTraitIndex] = necklaceTrait;\r\n        }\r\n\r\n        function decrementCharmStat(careerStat, property1Id, property2Id, traitId) {\r\n            let charmProperty1Index = careerStat.charm.properties.findIndex((property) => {return property.id === property1Id;});\r\n            let charmProperty2Index = careerStat.charm.properties.findIndex((property) => {return property.id === property2Id;});\r\n            let charmTraitIndex = careerStat.charm.traits.findIndex((trait) => {return trait.id === traitId;});    \r\n\r\n            let charmProperty1 = careerStat.charm.properties[charmProperty1Index];\r\n            let charmProperty2 = careerStat.charm.properties[charmProperty2Index];\r\n            let charmTrait = careerStat.charm.traits[charmTraitIndex];\r\n\r\n            charmProperty1.count -= 1;\r\n            charmProperty2.count -= 1;\r\n            charmTrait.count -= 1;\r\n\r\n            careerStat.charm.properties[charmProperty1Index] = charmProperty1;\r\n            careerStat.charm.properties[charmProperty2Index] = charmProperty2;\r\n            careerStat.charm.traits[charmTraitIndex] = charmTrait;\r\n        }\r\n\r\n        function decrementTrinketStat(careerStat, property1Id, property2Id, traitId) {\r\n            let trinketProperty1Index = careerStat.trinket.properties.findIndex((property) => {return property.id === property1Id;});\r\n            let trinketProperty2Index = careerStat.trinket.properties.findIndex((property) => {return property.id === property2Id;});\r\n            let trinketTraitIndex = careerStat.trinket.traits.findIndex((trait) => {return trait.id === traitId;});                        \r\n\r\n            let trinketProperty1 = careerStat.trinket.properties[trinketProperty1Index];\r\n            let trinketProperty2 = careerStat.trinket.properties[trinketProperty2Index];\r\n            let trinketTrait = careerStat.trinket.traits[trinketTraitIndex];\r\n\r\n            trinketProperty1.count -= 1;\r\n            trinketProperty2.count -= 1;\r\n            trinketTrait.count -= 1;\r\n\r\n            careerStat.trinket.properties[trinketProperty1Index] = trinketProperty1;\r\n            careerStat.trinket.properties[trinketProperty2Index] = trinketProperty2;\r\n            careerStat.trinket.traits[trinketTraitIndex] = trinketTrait;\r\n        }\r\n\r\n        function isCareerOrGearChanged(build) {\r\n            return !(state.careerId === build.data().careerId &&\r\n            state.primaryWeaponId === build.data().primaryWeapon.id &&\r\n            state.secondaryWeaponId === build.data().secondaryWeapon.id &&\r\n            state.properties[Constants.PRIMARY_PROPERTY1_INDEX] === build.data().primaryWeapon.property1Id &&\r\n            state.properties[Constants.PRIMARY_PROPERTY2_INDEX] === build.data().primaryWeapon.property2Id &&\r\n            state.properties[Constants.SECONDARY_PROPERTY1_INDEX] === build.data().secondaryWeapon.property1Id &&\r\n            state.properties[Constants.SECONDARY_PROPERTY2_INDEX] === build.data().secondaryWeapon.property2Id &&\r\n            state.properties[Constants.NECKLACE_PROPERTY1_INDEX] === build.data().necklace.property1Id &&\r\n            state.properties[Constants.NECKLACE_PROPERTY2_INDEX] === build.data().necklace.property2Id &&\r\n            state.properties[Constants.CHARM_PROPERTY1_INDEX] === build.data().charm.property1Id &&\r\n            state.properties[Constants.CHARM_PROPERTY2_INDEX] === build.data().charm.property2Id &&\r\n            state.properties[Constants.TRINKET_PROPERTY1_INDEX] === build.data().trinket.property1Id &&\r\n            state.properties[Constants.TRINKET_PROPERTY2_INDEX] === build.data().trinket.property2Id &&\r\n            state.traits[Constants.PRIMARY_TRAIT_INDEX] === build.data().primaryWeapon.trait &&\r\n            state.traits[Constants.SECONDARY_TRAIT_INDEX] === build.data().secondaryWeapon.trait &&\r\n            state.traits[Constants.NECKLACE_TRAIT_INDEX] === build.data().necklace.trait &&\r\n            state.traits[Constants.CHARM_TRAIT_INDEX] === build.data().charm.trait &&\r\n            state.traits[Constants.TRINKET_TRAIT_INDEX] === build.data().trinket.trait);\r\n        }\r\n\r\n        function updateBuildAndStats() {\r\n            let buildStatsRef = db.collection('builds').doc('stats');\r\n            let buildRef = db.collection('builds').doc(state.buildId);\r\n\r\n            db.runTransaction((transaction) => {\r\n                return transaction.getAll(buildStatsRef, buildRef).then((querySnapshot) => {\r\n                    if (!querySnapshot || querySnapshot.size < 2) {\r\n                        console.log('Could not find stats and build document');\r\n                        return;\r\n                    }\r\n\r\n                    let buildStats = querySnapshot.docs[0];\r\n                    let build = querySnapshot.docs[1];\r\n\r\n                    let careers = buildStats.data().careers;\r\n\r\n                    let newCareerIndex = careers.findIndex((career) => { return career.id === state.careerId});\r\n                    let newCareerStat = careers[newCareerIndex];\r\n                    let oldCareerIndex = careers.findIndex((career) => { return career.id === build.data().careerId});\r\n                    let oldCareerStat = careers[oldCareerIndex];\r\n\r\n                    // PREPARE BUILD STATS\r\n\r\n                    if (isCareerOrGearChanged(build)) {\r\n                        //build equipment or career has changed, update stats in addition to saving changes\r\n                    \r\n                        if (state.careerId !== build.data().careerId) { // Career changed, decrement all stats from old career, increment all in new career\r\n            \r\n                            if (!newCareerStat) {\r\n                                newCareerStat = {\r\n                                    id: state.careerId,\r\n                                    count: 0,\r\n                                    weapons: [],\r\n                                    necklace: {\r\n                                        properties: [],\r\n                                        traits: []\r\n                                    },\r\n                                    charm: {\r\n                                        properties: [],\r\n                                        traits: []\r\n                                    },\r\n                                    trinket: {\r\n                                        properties: [],\r\n                                        traits: []\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                            newCareerStat.count +=1;\r\n                            oldCareerStat.count -= 1;\r\n                            \r\n                            decrementWeaponStat(oldCareerStat, build.data().primaryWeapon.id, build.data().primaryWeapon.property1Id, build.data().primaryWeapon.property2Id, build.data().primaryWeapon.traitId);\r\n                            decrementWeaponStat(oldCareerStat, build.data().secondayWeapon.id, build.data().secondayWeapon.property1Id, build.data().secondayWeapon.property2Id, build.data().secondayWeapon.traitId);\r\n                            decrementNecklaceStat(oldCareerStat, build.data().necklace.property1Id, build.data().necklace.property2Id, build.data().necklace.traitId);\r\n                            decrementCharmStat(oldCareerStat, build.data().charm.property1Id, build.data().charm.property2Id, build.data().charm.traitId);\r\n                            decrementTrinketStat(oldCareerStat, build.data().trinket.property1Id, build.data().trinket.property2Id, build.data().trinket.traitId);\r\n                            \r\n                            incrementWeaponStat(newCareerStat, state.primaryWeaponId, state.properties[Constants.PRIMARY_PROPERTY1_INDEX], state.properties[Constants.PRIMARY_PROPERTY2_INDEX], state.properties[Constants.PRIMARY_TRAIT_INDEX]);\r\n                            incrementWeaponStat(newCareerStat, state.secondaryWeaponId, state.properties[Constants.SECONDARY_PROPERTY1_INDEX], state.properties[Constants.SECONDARY_PROPERTY2_INDEX], state.properties[Constants.SECONDARY_TRAIT_INDEX]);\r\n                            incrementNecklaceStat(newCareerStat, state.properties[Constants.NECKLACE_PROPERTY1_INDEX], state.properties[Constants.NECKLACE_PROPERTY2_INDEX], state.properties[Constants.NECKLACE_TRAIT_INDEX]);\r\n                            incrementCharmStat(newCareerStat, state.properties[Constants.CHARM_PROPERTY1_INDEX], state.properties[Constants.CHARM_PROPERTY2_INDEX], state.properties[Constants.CHARM_TRAIT_INDEX]);\r\n                            incrementTrinketStat(newCareerStat, state.properties[Constants.TRINKET_PROPERTY1_INDEX], state.properties[Constants.TRINKET_PROPERTY2_INDEX], state.properties[Constants.TRINKET_TRAIT_INDEX]);\r\n                        }\r\n                        else { // Check properties and traits of each weapon and gear item and increment/decrement where necessary\r\n                            if (state.primaryWeaponId !== build.data().primaryWeapon.id) {\r\n                                decrementWeaponStat(oldCareerStat, build.data().primaryWeapon.id, build.data().primaryWeapon.property1Id, build.data().primaryWeapon.property2Id, build.data().primaryWeapon.traitId);\r\n                                incrementWeaponStat(newCareerStat, state.primaryWeaponId, state.properties[Constants.PRIMARY_PROPERTY1_INDEX], state.properties[Constants.PRIMARY_PROPERTY2_INDEX], state.properties[Constants.PRIMARY_TRAIT_INDEX]);\r\n                            } else {\r\n                                // Weapon is the same as before, only adjust properties/traits\r\n                                let weaponIndex = oldCareerStat.weapons.findIndex((item) => { return item.id === build.data().primaryWeapon.id;});\r\n                                let weapon = oldCareerStat.weapons[weaponIndex];\r\n\r\n                                //check if properties or trait changed\r\n                                if (state.properties[Constants.PRIMARY_PROPERTY1_INDEX] !== build.data().primaryWeapon.property1Id) {\r\n                                    // decrement property\r\n                                    decrementStat(weapon.properties, build.data().primaryWeapon.property1Id);\r\n                                    incrementStat(weapon.properties, state.properties[Constants.PRIMARY_PROPERTY1_INDEX]);\r\n                                }\r\n                                if (state.properties[Constants.PRIMARY_PROPERTY2_INDEX] !== build.data().primaryWeapon.property2Id) {\r\n                                    // decrement property\r\n                                    decrementStat(weapon.properties, build.data().primaryWeapon.property2Id);\r\n                                    incrementStat(weapon.properties, state.properties[Constants.PRIMARY_PROPERTY2_INDEX]);\r\n                                }\r\n                                if (state.traits[Constants.PRIMARY_TRAIT_INDEX] !== build.data().primaryWeapon.traitId) {\r\n                                    // decrement trait\r\n                                    decrementStat(weapon.traits, build.data().primaryWeapon.traitId);\r\n                                    incrementStat(weapon.traits, state.traits[Constants.PRIMARY_TRAIT_INDEX]);\r\n                                }\r\n\r\n                            }\r\n\r\n                            if (state.secondaryWeaponId !== build.data().secondaryWeapon.id) {\r\n                                decrementWeaponStat(oldCareerStat, build.data().secondayWeapon.id, build.data().secondayWeapon.property1Id, build.data().secondayWeapon.property2Id, build.data().secondayWeapon.traitId);\r\n                                incrementWeaponStat(newCareerStat, state.secondaryWeaponId, state.properties[Constants.SECONDARY_PROPERTY1_INDEX], state.properties[Constants.SECONDARY_PROPERTY2_INDEX], state.properties[Constants.SECONDARY_TRAIT_INDEX]);\r\n                            } else {\r\n                                // Weapon is the same as before, only adjust properties/traits\r\n                                let weaponIndex = oldCareerStat.weapons.findIndex((item) => { return item.id === build.data().secondaryWeapon.id;});\r\n                                let weapon = oldCareerStat.weapons[weaponIndex];\r\n\r\n                                //check if properties or trait changed\r\n                                if (state.properties[Constants.SECONDARY_PROPERTY1_INDEX] !== build.data().secondaryWeapon.property1Id) {\r\n                                    // decrement property\r\n                                    decrementStat(weapon.properties, build.data().secondaryWeapon.property1Id);\r\n                                    incrementStat(weapon.properties, state.properties[Constants.SECONDARY_PROPERTY1_INDEX]);\r\n                                }\r\n                                if (state.properties[Constants.SECONDARY_PROPERTY2_INDEX] !== build.data().secondaryWeapon.property2Id) {\r\n                                    // decrement property\r\n                                    decrementStat(weapon.properties, build.data().secondaryWeapon.property2Id);\r\n                                    incrementStat(weapon.properties, state.properties[Constants.SECONDARY_PROPERTY2_INDEX]);\r\n                                }\r\n                                if (state.traits[Constants.SECONDARY_TRAIT_INDEX] !== build.data().secondaryWeapon.traitId) {\r\n                                    // decrement trait\r\n                                    decrementStat(weapon.traits, build.data().secondaryWeapon.traitId);\r\n                                    incrementStat(weapon.traits, state.traits[Constants.SECONDARY_TRAIT_INDEX]);\r\n                                }\r\n                            }\r\n\r\n                            // REPEAT this for each property and trait\r\n                            if (state.properties[Constants.NECKLACE_PROPERTY1_INDEX] !== build.data().necklace.property1Id) {\r\n                                // decrement property\r\n                                decrementStat(weapon.properties, build.data().necklace.property1Id);\r\n                                incrementStat(weapon.properties, state.properties[Constants.NECKLACE_PROPERTY1_INDEX]);\r\n                            }\r\n                            if (state.properties[Constants.NECKLACE_PROPERTY2_INDEX] !== build.data().necklace.property2Id) {\r\n                                // decrement property\r\n                                decrementStat(weapon.properties, build.data().necklace.property2Id);\r\n                                incrementStat(weapon.properties, state.properties[Constants.NECKLACE_PROPERTY2_INDEX]);\r\n                            }\r\n                            if (state.traits[Constants.NECKLACE_TRAIT_INDEX] !== build.data().necklace.traitId) {\r\n                                // decrement trait\r\n                                decrementStat(weapon.traits, build.data().necklace.traitId);\r\n                                incrementStat(weapon.traits, state.traits[Constants.NECKLACE_TRAIT_INDEX]);\r\n                            }\r\n                            \r\n                            if (state.properties[Constants.CHARM_PROPERTY1_INDEX] !== build.data().charm.property1Id) {\r\n                                // decrement property\r\n                                decrementStat(weapon.properties, build.data().charm.property1Id);\r\n                                incrementStat(weapon.properties, state.properties[Constants.CHARM_PROPERTY1_INDEX]);\r\n                            }\r\n                            if (state.properties[Constants.CHARM_PROPERTY2_INDEX] !== build.data().charm.property2Id) {\r\n                                // decrement property\r\n                                decrementStat(weapon.properties, build.data().charm.property2Id);\r\n                                incrementStat(weapon.properties, state.properties[Constants.CHARM_PROPERTY2_INDEX]);\r\n                            }\r\n                            if (state.traits[Constants.CHARM_TRAIT_INDEX] !== build.data().charm.traitId) {\r\n                                // decrement trait\r\n                                decrementStat(weapon.traits, build.data().charm.traitId);\r\n                                incrementStat(weapon.traits, state.traits[Constants.CHARM_TRAIT_INDEX]);\r\n                            }\r\n                            \r\n                            if (state.properties[Constants.TRINKET_PROPERTY1_INDEX] !== build.data().trinket.property1Id) {\r\n                                // decrement property\r\n                                decrementStat(weapon.properties, build.data().trinket.property1Id);\r\n                                incrementStat(weapon.properties, state.properties[Constants.TRINKET_PROPERTY1_INDEX]);\r\n                            }\r\n                            if (state.properties[Constants.TRINKET_PROPERTY2_INDEX] !== build.data().trinket.property2Id) {\r\n                                // decrement property\r\n                                decrementStat(weapon.properties, build.data().trinket.property2Id);\r\n                                incrementStat(weapon.properties, state.properties[Constants.TRINKET_PROPERTY2_INDEX]);\r\n                            }\r\n                            if (state.traits[Constants.TRINKET_TRAIT_INDEX] !== build.data().trinket.traitId) {\r\n                                // decrement trait\r\n                                decrementStat(weapon.traits, build.data().trinket.traitId);\r\n                                incrementStat(weapon.traits, state.traits[Constants.TRINKET_TRAIT_INDEX]);\r\n                            }\r\n                        }\r\n                    }\r\n/* \r\n                    let newPrimaryWeapon = newCareerStat.weapons ? newCareerStat.weapons.find((weapon) => {return weapon.id === state.primaryWeaponId;}) : null;\r\n                    let oldPrimaryWeapon = null\r\n\r\n                    if (!newPrimaryWeapon) {\r\n                        newPrimaryWeapon = {\r\n                            id: state.primaryWeaponId,\r\n                            count: 0,\r\n                            properties: [],\r\n                            traits: []\r\n                        }\r\n                    }\r\n                    \r\n                    if (state.primaryWeaponId !== build.data().primaryWeaponId) {\r\n\r\n                    }\r\n\r\n                    newPrimaryWeapon.count += 1;\r\n\r\n                    var newProperty1 = newPrimaryWeapon.properties ? newPrimaryWeapon.properties.find((property) => {return property.id === state.properties[Constants.PRIMARY_PROPERTY1_INDEX];}) : null;\r\n\r\n                    if (!newProperty1) {\r\n                        newProperty1 = {\r\n                            id: state.properties[Constants.PRIMARY_PROPERTY1_INDEX],\r\n                            count: 0\r\n                        }\r\n                    }\r\n\r\n                    newProperty1.count += 1;\r\n\r\n                    var newProperty2 = newPrimaryWeapon.properties ? newPrimaryWeapon.properties.find((property) => {return property.id === state.properties[Constants.PRIMARY_PROPERTY2_INDEX];}) : null;\r\n\r\n                    if (!newProperty2) {\r\n                        newProperty2 = {\r\n                            id: state.properties[Constants.PRIMARY_PROPERTY2_INDEX],\r\n                            count: 0\r\n                        }\r\n                    }\r\n\r\n                    newProperty2.count += 1;\r\n\r\n                    var newTrait = newPrimaryWeapon.traits ? newPrimaryWeapon.traits.find((trait) => {return trait.id === state.traits[Constants.PRIMARY_TRAIT_INDEX];}) : null;\r\n\r\n                    if (!newTrait) {\r\n                        newTrait = {\r\n                            id: state.properties[Constants.PRIMARY_PROPERTY2_INDEX],\r\n                            count: 0\r\n                        }\r\n                    }\r\n\r\n                    newTrait.count += 1;\r\n\r\n                    var newTraitIndex = newPrimaryWeapon.traits ? newPrimaryWeapon.traits.findIndex((trait) => { return trait.id === newTrait.id}) : -1;\r\n                    if (newTraitIndex < 0) {\r\n                        newPrimaryWeapon.traits ? newPrimaryWeapon.traits.push(newTrait) : newPrimaryWeapon.traits = [newTrait];\r\n                    }\r\n                    else {\r\n                        newPrimaryWeapon.traits[newTraitIndex] = newTrait;\r\n                    }\r\n\r\n                    var newProperty1Index = newPrimaryWeapon.properties ? newPrimaryWeapon.properties.findIndex((property) => { return property.id === newProperty1.id}) : -1;\r\n                    if (newProperty1Index < 0) {\r\n                        newPrimaryWeapon.properties ? newPrimaryWeapon.properties.push(newProperty1) : newPrimaryWeapon.properties = [newProperty1];\r\n                    }\r\n                    else {\r\n                        newPrimaryWeapon.properties[newProperty1Index] = newProperty1;\r\n                    }\r\n\r\n                    var newProperty2Index = newPrimaryWeapon.properties ? newPrimaryWeapon.properties.findIndex((property) => { return property.id === newProperty2.id}) : -1;\r\n                    if (newProperty2Index < 0) {\r\n                        newPrimaryWeapon.properties ? newPrimaryWeapon.properties.push(newProperty2) : newPrimaryWeapon.properties = [newProperty2];\r\n                    }\r\n                    else {\r\n                        newPrimaryWeapon.properties[newProperty2Index] = newProperty2;\r\n                    }\r\n\r\n                    var newPrimaryWeaponIndex = newCareerStat.weapons ? newCareerStat.weapons.findIndex((weapon) => { return weapon.id === newPrimaryWeapon.id}) : -1;\r\n                    if (newPrimaryWeaponIndex < 0) {\r\n                        newCareerStat.weapons ? newCareerStat.weapons.push(newPrimaryWeapon) : newCareerStat.weapons = [newPrimaryWeapon];\r\n                    }\r\n                    else {\r\n                        newCareerStat.weapons[newPrimaryWeaponIndex] = newPrimaryWeapon;\r\n                    }\r\n\r\n                    var newCareerStatIndex = careers ? careers.findIndex((career) => { return career.id === newCareerStat.id}) : -1;\r\n                    if (newCareerStatIndex < 0) {\r\n                        careers ? careers.push(newCareerStat) : careers = [newCareerStat];\r\n                    }\r\n                    else {\r\n                        careers[newCareerStatIndex] = newCareerStat;\r\n                    } */\r\n\r\n                    careers[oldCareerIndex] = oldCareerStat;\r\n                    careers[newCareerIndex] = newCareerStat;\r\n                    \r\n                    transaction.update(buildStatsRef, { careers: careers });\r\n                        \r\n                \r\n                });\r\n            }).then(() => {\r\n                console.log('successfully updated stats');\r\n            });\r\n        }\r\n\r\n        function createBuild() {\r\n            console.log('Creating new build.');\r\n            let increment = 1;//firebase.firestore.FieldValue.increment(1);\r\n\r\n            let batch = db.batch();\r\n\r\n            let buildStatsRef = db.collection('builds').doc('stats');\r\n\r\n            db.runTransaction((transaction) => {\r\n                return transaction.get(buildStatsRef).then((buildStats) => {\r\n                    if (!buildStats) {\r\n                        console.log('No stats document found');\r\n                        return;\r\n                    }\r\n\r\n                    console.log(buildStats.data());\r\n\r\n                    var careers = buildStats.data().careers;\r\n\r\n                    var newCareerStat = careers.find((career) => {return career.id === state.careerId;});\r\n                    console.log(newCareerStat);\r\n\r\n                    if (!newCareerStat) {\r\n                        newCareerStat = {\r\n                            id: state.careerId,\r\n                            count: 0,\r\n                            weapons: []\r\n                        }\r\n                    }\r\n\r\n                    newCareerStat.count += 1;\r\n\r\n                    var newPrimaryWeapon = newCareerStat.weapons ? newCareerStat.weapons.find((weapon) => {return weapon.id === state.primaryWeaponId;}) : null;\r\n\r\n                    if (!newPrimaryWeapon) {\r\n                        newPrimaryWeapon = {\r\n                            id: state.primaryWeaponId,\r\n                            count: 0,\r\n                            properties: [],\r\n                            traits: []\r\n                        }\r\n                    }\r\n\r\n                    newPrimaryWeapon.count += 1;\r\n\r\n                    var newProperty1 = newPrimaryWeapon.properties ? newPrimaryWeapon.properties.find((property) => {return property.id === state.properties[Constants.PRIMARY_PROPERTY1_INDEX];}) : null;\r\n\r\n                    if (!newProperty1) {\r\n                        newProperty1 = {\r\n                            id: state.properties[Constants.PRIMARY_PROPERTY1_INDEX],\r\n                            count: 0\r\n                        }\r\n                    }\r\n\r\n                    newProperty1.count += 1;\r\n\r\n                    var newProperty2 = newPrimaryWeapon.properties ? newPrimaryWeapon.properties.find((property) => {return property.id === state.properties[Constants.PRIMARY_PROPERTY2_INDEX];}) : null;\r\n\r\n                    if (!newProperty2) {\r\n                        newProperty2 = {\r\n                            id: state.properties[Constants.PRIMARY_PROPERTY2_INDEX],\r\n                            count: 0\r\n                        }\r\n                    }\r\n\r\n                    newProperty2.count += 1;\r\n\r\n                    var newTrait = newPrimaryWeapon.traits ? newPrimaryWeapon.traits.find((trait) => {return trait.id === state.traits[Constants.PRIMARY_TRAIT_INDEX];}) : null;\r\n\r\n                    if (!newTrait) {\r\n                        newTrait = {\r\n                            id: state.properties[Constants.PRIMARY_PROPERTY2_INDEX],\r\n                            count: 0\r\n                        }\r\n                    }\r\n\r\n                    newTrait.count += 1;\r\n\r\n                    var newTraitIndex = newPrimaryWeapon.traits ? newPrimaryWeapon.traits.findIndex((trait) => { return trait.id === newTrait.id}) : -1;\r\n                    if (newTraitIndex < 0) {\r\n                        newPrimaryWeapon.traits ? newPrimaryWeapon.traits.push(newTrait) : newPrimaryWeapon.traits = [newTrait];\r\n                    }\r\n                    else {\r\n                        newPrimaryWeapon.traits[newTraitIndex] = newTrait;\r\n                    }\r\n\r\n                    var newProperty1Index = newPrimaryWeapon.properties ? newPrimaryWeapon.properties.findIndex((property) => { return property.id === newProperty1.id}) : -1;\r\n                    if (newProperty1Index < 0) {\r\n                        newPrimaryWeapon.properties ? newPrimaryWeapon.properties.push(newProperty1) : newPrimaryWeapon.properties = [newProperty1];\r\n                    }\r\n                    else {\r\n                        newPrimaryWeapon.properties[newProperty1Index] = newProperty1;\r\n                    }\r\n\r\n                    var newProperty2Index = newPrimaryWeapon.properties ? newPrimaryWeapon.properties.findIndex((property) => { return property.id === newProperty2.id}) : -1;\r\n                    if (newProperty2Index < 0) {\r\n                        newPrimaryWeapon.properties ? newPrimaryWeapon.properties.push(newProperty2) : newPrimaryWeapon.properties = [newProperty2];\r\n                    }\r\n                    else {\r\n                        newPrimaryWeapon.properties[newProperty2Index] = newProperty2;\r\n                    }\r\n\r\n                    var newPrimaryWeaponIndex = newCareerStat.weapons ? newCareerStat.weapons.findIndex((weapon) => { return weapon.id === newPrimaryWeapon.id}) : -1;\r\n                    if (newPrimaryWeaponIndex < 0) {\r\n                        newCareerStat.weapons ? newCareerStat.weapons.push(newPrimaryWeapon) : newCareerStat.weapons = [newPrimaryWeapon];\r\n                    }\r\n                    else {\r\n                        newCareerStat.weapons[newPrimaryWeaponIndex] = newPrimaryWeapon;\r\n                    }\r\n\r\n                    var newCareerStatIndex = careers ? careers.findIndex((career) => { return career.id === newCareerStat.id}) : -1;\r\n                    if (newCareerStatIndex < 0) {\r\n                        careers ? careers.push(newCareerStat) : careers = [newCareerStat];\r\n                    }\r\n                    else {\r\n                        careers[newCareerStatIndex] = newCareerStat;\r\n                    }\r\n                    \r\n                    transaction.update(buildStatsRef, { careers: careers });\r\n                    transaction.set(db.collection('builds').doc(), {\r\n                        careerId: state.careerId,                    \r\n                        primaryWeapon: {\r\n                            id: state.primaryWeaponId,\r\n                            property1Id: state.properties[Constants.PRIMARY_PROPERTY1_INDEX],\r\n                            property2Id: state.properties[Constants.PRIMARY_PROPERTY2_INDEX],\r\n                            traitId: state.traits[Constants.PRIMARY_TRAIT_INDEX]\r\n                        },\r\n                        secondaryWeapon: {\r\n                            id: state.secondaryWeaponId,\r\n                            property1Id: state.properties[Constants.SECONDARY_PROPERTY1_INDEX],\r\n                            property2Id: state.properties[Constants.SECONDARY_PROPERTY2_INDEX],\r\n                            traitId: state.traits[Constants.SECONDARY_TRAIT_INDEX]\r\n                        },\r\n                        necklace: {\r\n                            property1Id: state.properties[Constants.NECKLACE_PROPERTY1_INDEX],\r\n                            property2Id: state.properties[Constants.NECKLACE_PROPERTY2_INDEX],\r\n                            traitId: state.traits[Constants.NECKLACE_TRAIT_INDEX]\r\n                        },\r\n                        charm: {\r\n                            property1Id: state.properties[Constants.CHARM_PROPERTY1_INDEX],\r\n                            property2Id: state.properties[Constants.CHARM_PROPERTY2_INDEX],\r\n                            traitId: state.traits[Constants.CHARM_TRAIT_INDEX]\r\n                        },\r\n                        trinket: {\r\n                            property1Id: state.properties[Constants.TRINKET_PROPERTY1_INDEX],\r\n                            property2Id: state.properties[Constants.TRINKET_PROPERTY2_INDEX],\r\n                            traitId: state.traits[Constants.TRINKET_TRAIT_INDEX]\r\n                        },\r\n                        talent1: state.talents[Constants.TALENT_TIER_1],\r\n                        talent2: state.talents[Constants.TALENT_TIER_2],\r\n                        talent3: state.talents[Constants.TALENT_TIER_3],\r\n                        talent4: state.talents[Constants.TALENT_TIER_4],\r\n                        talent5: state.talents[Constants.TALENT_TIER_5],\r\n                        talent6: state.talents[Constants.TALENT_TIER_6],\r\n                        name: state.name,\r\n                        description: state.description,\r\n                        difficulties: state.difficulties.map((item) => { return item.id }),\r\n                        missions: state.missions.map((item) => { return item.id }),\r\n                        potions: state.potions.map((item) => { return item.id }),\r\n                        roles: state.roles.map((item) => { return item.id }),\r\n                        books: state.books.map((item) => { return item.id }),\r\n                        likeCount: 0,\r\n                        dateCreated: new Date(),\r\n                        dateModified: new Date(),\r\n                        userId: auth.currentUser.uid,\r\n                        username: auth.currentUser.displayName,\r\n                        videos: state.videos,\r\n                        isDeleted: false\r\n                    });\r\n                });\r\n            }).then(() => {\r\n                console.log('successfully updated stats');\r\n            });\r\n\r\n/*             batch.set(db.collection('builds').doc(), {\r\n                careerId: state.careerId,                    \r\n                primaryWeapon: {\r\n                    id: state.primaryWeaponId,\r\n                    property1Id: state.properties[Constants.PRIMARY_PROPERTY1_INDEX],\r\n                    property2Id: state.properties[Constants.PRIMARY_PROPERTY2_INDEX],\r\n                    traitId: state.traits[Constants.PRIMARY_TRAIT_INDEX]\r\n                },\r\n                secondaryWeapon: {\r\n                    id: state.secondaryWeaponId,\r\n                    property1Id: state.properties[Constants.SECONDARY_PROPERTY1_INDEX],\r\n                    property2Id: state.properties[Constants.SECONDARY_PROPERTY2_INDEX],\r\n                    traitId: state.traits[Constants.SECONDARY_TRAIT_INDEX]\r\n                },\r\n                necklace: {\r\n                    property1Id: state.properties[Constants.NECKLACE_PROPERTY1_INDEX],\r\n                    property2Id: state.properties[Constants.NECKLACE_PROPERTY2_INDEX],\r\n                    traitId: state.traits[Constants.NECKLACE_TRAIT_INDEX]\r\n                },\r\n                charm: {\r\n                    property1Id: state.properties[Constants.CHARM_PROPERTY1_INDEX],\r\n                    property2Id: state.properties[Constants.CHARM_PROPERTY2_INDEX],\r\n                    traitId: state.traits[Constants.CHARM_TRAIT_INDEX]\r\n                },\r\n                trinket: {\r\n                    property1Id: state.properties[Constants.TRINKET_PROPERTY1_INDEX],\r\n                    property2Id: state.properties[Constants.TRINKET_PROPERTY2_INDEX],\r\n                    traitId: state.traits[Constants.TRINKET_TRAIT_INDEX]\r\n                },\r\n                talent1: state.talents[Constants.TALENT_TIER_1],\r\n                talent2: state.talents[Constants.TALENT_TIER_2],\r\n                talent3: state.talents[Constants.TALENT_TIER_3],\r\n                talent4: state.talents[Constants.TALENT_TIER_4],\r\n                talent5: state.talents[Constants.TALENT_TIER_5],\r\n                talent6: state.talents[Constants.TALENT_TIER_6],\r\n                name: state.name,\r\n                description: state.description,\r\n                difficulties: state.difficulties.map((item) => { return item.id }),\r\n                missions: state.missions.map((item) => { return item.id }),\r\n                potions: state.potions.map((item) => { return item.id }),\r\n                roles: state.roles.map((item) => { return item.id }),\r\n                books: state.books.map((item) => { return item.id }),\r\n                likeCount: 0,\r\n                dateCreated: new Date(),\r\n                dateModified: new Date(),\r\n                userId: auth.currentUser.uid,\r\n                username: auth.currentUser.displayName,\r\n                videos: state.videos,\r\n                isDeleted: false\r\n            });\r\n            batch.commit(); */\r\n\r\n/*             db.collection('builds').doc('stats').set({\r\n                careers: [\r\n                    {\r\n                        id: state.careerId,\r\n                        count: increment,\r\n                        weapons: [\r\n                            {\r\n                                id: state.primaryWeaponId,\r\n                                count: increment,\r\n                                properties: [\r\n                                    {\r\n                                        id: state.properties[Constants.PRIMARY_PROPERTY1_INDEX],\r\n                                        count: increment\r\n                                    },\r\n                                    {\r\n                                        id: state.properties[Constants.PRIMARY_PROPERTY2_INDEX],\r\n                                        count: increment\r\n                                    }\r\n                                ],\r\n                                traits: [\r\n                                    {\r\n                                        id: state.traits[Constants.PRIMARY_TRAIT_INDEX],\r\n                                        count: increment\r\n                                    }\r\n                                ]\r\n                            },\r\n                            {\r\n                                id: state.secondaryWeaponId,\r\n                                count: increment,\r\n                                properties: [\r\n                                    {\r\n                                        id: state.properties[Constants.SECONDARY_PROPERTY1_INDEX],\r\n                                        count: increment\r\n                                    },\r\n                                    {\r\n                                        id: state.properties[Constants.SECONDARY_PROPERTY2_INDEX],\r\n                                        count: increment\r\n                                    }\r\n                                ],\r\n                                traits: [\r\n                                    {\r\n                                        id: state.traits[Constants.SECONDARY_TRAIT_INDEX],\r\n                                        count: increment\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }); */\r\n\r\n/*             db.collection('builds').add({\r\n                careerId: state.careerId,                    \r\n                primaryWeapon: {\r\n                    id: state.primaryWeaponId,\r\n                    property1Id: state.properties[Constants.PRIMARY_PROPERTY1_INDEX],\r\n                    property2Id: state.properties[Constants.PRIMARY_PROPERTY2_INDEX],\r\n                    traitId: state.traits[Constants.PRIMARY_TRAIT_INDEX]\r\n                },\r\n                secondaryWeapon: {\r\n                    id: state.secondaryWeaponId,\r\n                    property1Id: state.properties[Constants.SECONDARY_PROPERTY1_INDEX],\r\n                    property2Id: state.properties[Constants.SECONDARY_PROPERTY2_INDEX],\r\n                    traitId: state.traits[Constants.SECONDARY_TRAIT_INDEX]\r\n                },\r\n                necklace: {\r\n                    property1Id: state.properties[Constants.NECKLACE_PROPERTY1_INDEX],\r\n                    property2Id: state.properties[Constants.NECKLACE_PROPERTY2_INDEX],\r\n                    traitId: state.traits[Constants.NECKLACE_TRAIT_INDEX]\r\n                },\r\n                charm: {\r\n                    property1Id: state.properties[Constants.CHARM_PROPERTY1_INDEX],\r\n                    property2Id: state.properties[Constants.CHARM_PROPERTY2_INDEX],\r\n                    traitId: state.traits[Constants.CHARM_TRAIT_INDEX]\r\n                },\r\n                trinket: {\r\n                    property1Id: state.properties[Constants.TRINKET_PROPERTY1_INDEX],\r\n                    property2Id: state.properties[Constants.TRINKET_PROPERTY2_INDEX],\r\n                    traitId: state.traits[Constants.TRINKET_TRAIT_INDEX]\r\n                },\r\n                talent1: state.talents[Constants.TALENT_TIER_1],\r\n                talent2: state.talents[Constants.TALENT_TIER_2],\r\n                talent3: state.talents[Constants.TALENT_TIER_3],\r\n                talent4: state.talents[Constants.TALENT_TIER_4],\r\n                talent5: state.talents[Constants.TALENT_TIER_5],\r\n                talent6: state.talents[Constants.TALENT_TIER_6],\r\n                name: state.name,\r\n                description: state.description,\r\n                difficulties: state.difficulties,\r\n                missions: state.missions,\r\n                potions: state.potions,\r\n                roles: state.roles,\r\n                books: state.books,\r\n                likeCount: 0,\r\n                dateCreated: new Date(),\r\n                dateModified: new Date(),\r\n                userId: auth.currentUser.uid,\r\n                username: auth.currentUser.displayName,\r\n                videos: state.videos,\r\n                isDeleted: false\r\n            }).then((docRef) => {\r\n                console.log(\"Document written with ID: \", docRef.id);\r\n                history.push('/build/' + docRef.id + '/edit');\r\n\r\n                //redirect to build edit page here\r\n\r\n            }).catch((error) => {\r\n                console.error(\"Error adding document: \", error);\r\n            }); */\r\n        }\r\n\r\n        function saveBuild() {\r\n            console.log('updating build, current state:');\r\n            console.log(state);\r\n\r\n            if (state.userId !== auth.currentUser.uid) {\r\n                alert('You can\\'t edit a build you didn\\'t create.');\r\n                return;\r\n            }\r\n\r\n            let buildDataRef = db.collection('builds').doc(state.buildId);\r\n\r\n            buildDataRef.set({\r\n                careerId: state.careerId,\r\n                primaryWeapon: {\r\n                    id: state.primaryWeaponId,\r\n                    property1Id: state.properties[Constants.PRIMARY_PROPERTY1_INDEX],\r\n                    property2Id: state.properties[Constants.PRIMARY_PROPERTY2_INDEX],\r\n                    traitId: state.traits[Constants.PRIMARY_TRAIT_INDEX]\r\n                },\r\n                secondaryWeapon: {\r\n                    id: state.secondaryWeaponId,\r\n                    property1Id: state.properties[Constants.SECONDARY_PROPERTY1_INDEX],\r\n                    property2Id: state.properties[Constants.SECONDARY_PROPERTY2_INDEX],\r\n                    traitId: state.traits[Constants.SECONDARY_TRAIT_INDEX]\r\n                },\r\n                necklace: {\r\n                    property1Id: state.properties[Constants.NECKLACE_PROPERTY1_INDEX],\r\n                    property2Id: state.properties[Constants.NECKLACE_PROPERTY2_INDEX],\r\n                    traitId: state.traits[Constants.NECKLACE_TRAIT_INDEX]\r\n                },\r\n                charm: {\r\n                    property1Id: state.properties[Constants.CHARM_PROPERTY1_INDEX],\r\n                    property2Id: state.properties[Constants.CHARM_PROPERTY2_INDEX],\r\n                    traitId: state.traits[Constants.CHARM_TRAIT_INDEX]\r\n                },\r\n                trinket: {\r\n                    property1Id: state.properties[Constants.TRINKET_PROPERTY1_INDEX],\r\n                    property2Id: state.properties[Constants.TRINKET_PROPERTY2_INDEX],\r\n                    traitId: state.traits[Constants.TRINKET_TRAIT_INDEX]\r\n                },\r\n/*                     primaryWeaponId: state.primaryWeaponId,\r\n                primaryWeaponProperty1: state.properties[Constants.PRIMARY_PROPERTY1_INDEX],\r\n                primaryWeaponProperty2:state.properties[Constants.PRIMARY_PROPERTY2_INDEX],\r\n                primaryWeaponTrait: state.traits[Constants.PRIMARY_TRAIT_INDEX],\r\n                secondaryWeaponId: state.secondaryWeaponId,\r\n                secondaryWeaponProperty1: state.properties[Constants.SECONDARY_PROPERTY1_INDEX],\r\n                secondaryWeaponProperty2: state.properties[Constants.SECONDARY_PROPERTY2_INDEX],\r\n                secondaryWeaponTrait: state.traits[Constants.SECONDARY_TRAIT_INDEX],\r\n                necklaceProperty1: state.properties[Constants.NECKLACE_PROPERTY1_INDEX],\r\n                necklaceProperty2: state.properties[Constants.NECKLACE_PROPERTY2_INDEX],\r\n                necklaceTrait: state.traits[Constants.NECKLACE_TRAIT_INDEX],\r\n                charmProperty1: state.properties[Constants.CHARM_PROPERTY1_INDEX],\r\n                charmProperty2: state.properties[Constants.CHARM_PROPERTY2_INDEX],\r\n                charmTrait: state.traits[Constants.CHARM_TRAIT_INDEX],\r\n                trinketProperty1: state.properties[Constants.TRINKET_PROPERTY1_INDEX],\r\n                trinketProperty2: state.properties[Constants.TRINKET_PROPERTY2_INDEX],\r\n                trinketTrait: state.traits[Constants.TRINKET_TRAIT_INDEX], */\r\n                talent1: state.talents[Constants.TALENT_TIER_1],\r\n                talent2: state.talents[Constants.TALENT_TIER_2],\r\n                talent3: state.talents[Constants.TALENT_TIER_3],\r\n                talent4: state.talents[Constants.TALENT_TIER_4],\r\n                talent5: state.talents[Constants.TALENT_TIER_5],\r\n                talent6: state.talents[Constants.TALENT_TIER_6],\r\n                name: state.name,\r\n                description: state.description,\r\n                difficulties: state.difficulties.map((item) => { return item.id }),\r\n                missions: state.missions.map((item) => { return item.id }),\r\n                potions: state.potions.map((item) => { return item.id }),\r\n                roles: state.roles.map((item) => { return item.id }),\r\n                books: state.books.map((item) => { return item.id }),\r\n                dateModified: new Date(),\r\n                //userId: auth.currentUser.uid,\r\n                //username: auth.currentUser.displayName,\r\n                //TODO - ensure that username is updated for each build when user edits their username\r\n                videos: state.videos,\r\n                isDeleted: false\r\n            }, {merge: true}).then(() => {\r\n                console.log(\"Document updated with ID: \", state.buildId);\r\n                \r\n                updateState({\r\n                    type: \"UPDATE_DIRTY\", \r\n                    payload: false\r\n                });\r\n\r\n                var buildSaveIndicator = document.getElementById('buildSaveIndicator');\r\n                buildSaveIndicator.classList.add('saved');\r\n                setTimeout(() => { buildSaveIndicator.classList.remove('saved'); }, 4000);\r\n\r\n            }).catch((error) => {\r\n                console.error(\"Error updating document: \", error);\r\n            });\r\n        }\r\n\r\n        //get build id param\r\n        //if empty, load nothing from DB\r\n        //if not empty, load build from DB and updatestate\r\n\r\n        //saving builds with /create/ url saves new db item and redirects to /buildId/edit page\r\n        //saving builds with /edit/ url just updates the record in the db\r\n\r\n        if (!state.isFromDb && !state.createBuild) {\r\n            return (\r\n                <div className=\"edit-build-page\" data-readonly={state.readonly} data-dirty={state.dirty}>\r\n                    <p>No build found</p>\r\n                </div>);\r\n        }\r\n\r\n        if (!auth.currentUser) {\r\n            return (\r\n                <div className=\"edit-build-page\" data-readonly={state.readonly} data-dirty={state.dirty}>\r\n                    <p>You must be logged in to edit builds</p>\r\n                </div>);\r\n        }\r\n\r\n        if (!state.createBuild && state.userId !== auth.currentUser.uid) {\r\n            return (\r\n                <div className=\"edit-build-page\" data-readonly={state.readonly} data-dirty={state.dirty}>\r\n                    <p>Cannot edit build that you didn't create</p>\r\n                </div>);\r\n        }\r\n\r\n        return (\r\n            <div className=\"edit-build-page build-page\" data-liked={state.isLiked} data-readonly={state.readonly} data-dirty={state.dirty} data-fresh={state.createBuild}>\r\n                <span id=\"buildSaveIndicator\" className=\"border-03 background-18\">Build saved...</span>\r\n                <div className=\"build-left-container\">\r\n                    <div className=\"build-buttons-container\">\r\n                        <span id=\"saveBuildButton\" className=\"button-01 border-04\" onClick={saveBuildClick.bind(this)}>Save Build</span>\r\n                    </div>                    \r\n                    <HeroSelect careerId={state.careerId}></HeroSelect>\r\n                </div>\r\n                <div className=\"build-main-container\">\r\n                    <Tabs>\r\n                        <TabList>\r\n                            <Tab>Summary</Tab>\r\n                            <Tab>Videos</Tab>\r\n                            <Tab>Combos</Tab>                        \r\n                        </TabList>\r\n                        <TabPanel className=\"build-summary-tab\">\r\n                            <div className=\"build-details-container\">\r\n                                <HeroDetails careerId={state.careerId}></HeroDetails>\r\n                                <input type=\"text\" className=\"build-name-input border-02 background-18\" placeholder=\"Name your build\" value={state.name} onChange={handleNameChange.bind(this)}></input>\r\n                                <textarea className=\"input-build-description border-02 background-18\" wrap=\"hard\" placeholder=\"Describe your build\" value={state.description} onChange={handleDescriptionChanged.bind(this)}></textarea>\r\n                                <BuildInformation></BuildInformation>\r\n                                <BuildOptions></BuildOptions>\r\n                            </div>\r\n                            <BuildSummary></BuildSummary>\r\n                        </TabPanel>\r\n                        <TabPanel>\r\n                            <div className=\"build-additional-info\">\r\n                            </div>\r\n                        </TabPanel>\r\n                        <TabPanel>\r\n                            <div className=\"hero-abilities\">\r\n                            </div>                        \r\n                        </TabPanel>\r\n                    </Tabs>\r\n                    <div className=\"build-talents-container\">\r\n                        <HeroTalents contextActionType=\"UPDATE_TALENTS\" careerId={state.careerId} talents={state.talents}></HeroTalents>\r\n                    </div>\r\n                </div>\r\n                <div className=\"build-right-container\">\r\n                    <Inventory></Inventory>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\nexport default EditBuildPage;"]},"metadata":{},"sourceType":"module"}