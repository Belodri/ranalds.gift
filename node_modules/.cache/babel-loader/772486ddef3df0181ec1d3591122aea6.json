{"ast":null,"code":"var _jsxFileName = \"C:\\\\dev\\\\ranalds.gift\\\\src\\\\components\\\\buildPage\\\\ViewBuildPage.js\";\nimport React, { useContext } from 'react';\nimport HeroTalents from '../heroTalents/HeroTalents';\nimport BuildList from '../buildList/BuildList';\nimport Inventory from '../inventory/Inventory';\nimport './ViewBuildPage.css';\nimport HeroDetails from '../heroDetails/HeroDetails';\nimport { Tab, Tabs, TabList, TabPanel } from 'react-tabs';\nimport \"react-tabs/style/react-tabs.css\";\nimport BuildOptions from './BuildOptions';\nimport BuildSummary from './BuildSummary';\nimport { AppContext } from '../../stores/Store';\nimport { useParams } from 'react-router';\nimport { db } from '../../utils/Firebase';\nimport { UserContext } from '../../stores/UserStore';\nimport { Link } from 'react-router-dom';\nimport BuildInformation from './BuildInformation';\n\nfunction ViewBuildPage() {\n  const [state, updateState] = useContext(AppContext);\n  const [userState, updateUserState] = useContext(UserContext);\n\n  if (!state.readonly) {\n    updateState({\n      type: \"UPDATE_READONLY\",\n      payload: true\n    });\n  }\n\n  let params = useParams();\n  console.log(!userState.userId);\n  /*         if (!userState.userId || userState.userId == '') {\r\n              console.log('props.userId');\r\n              return <div className=\"error-message\">Error loading build for edit</div>;\r\n          }  */\n\n  console.log('params build id: ' + params.buildId); //console.log(PatchList[0]);\n\n  var root = document.getElementById('root');\n  root.dataset.pageName = 'viewBuildPage';\n\n  if (params.buildId && state.buildId !== params.buildId) {\n    loadBuild(params.buildId);\n  }\n\n  function loadBuild(buildId) {\n    console.log('loading build id ' + buildId);\n\n    if (state.buildId !== buildId) {\n      state.buildId = buildId;\n    }\n\n    db.collection('builds').doc(buildId).get().then(build => {\n      if (!build.data()) {\n        console.log('No build found with ID ' + buildId);\n        return;\n      }\n\n      console.log('build loaded from db:');\n      console.log(build.data());\n      updateState({\n        type: 'INIT_STATE_FROM_DATA',\n        payload: build\n      }); // TODO: Get similar builds and builds from the user for side bar display\n\n      db.collection('builds').where(\"careerId\", \"==\", build.data().careerId).get().then(querySnapshot => {\n        var similarBuilds = [];\n        querySnapshot.forEach(build => {\n          if (build.id === buildId) {\n            return;\n          }\n\n          similarBuilds.push({\n            id: build.id,\n            data: build.data()\n          });\n        });\n        console.log('updating similar builds:');\n        console.log(similarBuilds);\n        updateState({\n          type: \"UPDATE_SIMILAR_BUILDS\",\n          payload: similarBuilds\n        });\n      });\n    }).catch(error => {\n      console.error('Error retrieving data from DB:', error);\n    });\n  } //get build id param\n  //if empty, load nothing from DB\n  //if not empty, load build from DB and updatestate\n  //saving builds with /create/ url saves new db item and redirects to /buildId/edit page\n  //saving builds with /edit/ url just updates the record in the db\n\n\n  if (!state.isFromDb) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"edit-build-page\",\n      \"data-readonly\": state.readonly,\n      \"data-dirty\": state.dirty,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 21\n      }\n    }, \"No build found\"));\n  }\n\n  console.log('build user id: ' + state.userId + ' user context id ' + userState.userId);\n  let isAuthor = state.userId === userState.userId;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"edit-build-page build-page\",\n    \"data-author\": isAuthor,\n    \"data-liked\": state.isLiked,\n    \"data-readonly\": state.readonly,\n    \"data-dirty\": state.dirty,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    id: \"buildSaveIndicator\",\n    className: \"border-03 background-18\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 17\n    }\n  }, \"Build saved...\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"build-left-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(BuildList, {\n    builds: state.similarBuilds,\n    name: \"Similar Builds\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"build-main-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Tabs, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(TabList, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Tab, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 29\n    }\n  }, \"Summary\"), /*#__PURE__*/React.createElement(Tab, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 29\n    }\n  }, \"Videos\"), /*#__PURE__*/React.createElement(Tab, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 29\n    }\n  }, \"Combos\")), /*#__PURE__*/React.createElement(TabPanel, {\n    className: \"build-summary-tab\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"build-details-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(HeroDetails, {\n    careerId: state.careerId,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 33\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    className: \"build-name-input border-02 background-18\",\n    placeholder: \"Name your build\",\n    value: state.name,\n    readOnly: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 33\n    }\n  }), /*#__PURE__*/React.createElement(Link, {\n    to: `/build/${state.buildId}/edit`,\n    className: \"edit-build-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 33\n    }\n  }, \"edit\"), /*#__PURE__*/React.createElement(\"textarea\", {\n    className: \"input-build-description border-02 background-18\",\n    wrap: \"hard\",\n    placeholder: \"Describe your build\",\n    value: state.description,\n    readOnly: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 33\n    }\n  }), /*#__PURE__*/React.createElement(BuildInformation, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 33\n    }\n  }), /*#__PURE__*/React.createElement(BuildOptions, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(BuildSummary, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(TabPanel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"build-additional-info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(TabPanel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"hero-abilities\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 29\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"build-talents-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(HeroTalents, {\n    contextActionType: \"UPDATE_TALENTS\",\n    careerId: state.careerId,\n    talents: state.talents,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"build-right-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Inventory, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 21\n    }\n  })));\n}\n\nexport default ViewBuildPage;","map":{"version":3,"sources":["C:/dev/ranalds.gift/src/components/buildPage/ViewBuildPage.js"],"names":["React","useContext","HeroTalents","BuildList","Inventory","HeroDetails","Tab","Tabs","TabList","TabPanel","BuildOptions","BuildSummary","AppContext","useParams","db","UserContext","Link","BuildInformation","ViewBuildPage","state","updateState","userState","updateUserState","readonly","type","payload","params","console","log","userId","buildId","root","document","getElementById","dataset","pageName","loadBuild","collection","doc","get","then","build","data","where","careerId","querySnapshot","similarBuilds","forEach","id","push","catch","error","isFromDb","dirty","isAuthor","isLiked","name","description","talents"],"mappings":"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","sourcesContent":["import React, {useContext} from 'react';\r\nimport HeroTalents from '../heroTalents/HeroTalents'\r\nimport BuildList from '../buildList/BuildList'\r\nimport Inventory from '../inventory/Inventory'\r\nimport './ViewBuildPage.css';\r\nimport HeroDetails from '../heroDetails/HeroDetails';\r\nimport { Tab, Tabs, TabList, TabPanel } from 'react-tabs';\r\nimport \"react-tabs/style/react-tabs.css\";\r\nimport BuildOptions from './BuildOptions';\r\nimport BuildSummary from './BuildSummary';\r\nimport { AppContext } from '../../stores/Store';\r\nimport { useParams } from 'react-router';\r\nimport { db } from '../../utils/Firebase';\r\nimport { UserContext } from '../../stores/UserStore';\r\nimport { Link } from 'react-router-dom';\r\nimport BuildInformation from './BuildInformation';\r\n\r\nfunction ViewBuildPage() {\r\n\r\n        const [state, updateState] = useContext(AppContext);\r\n        const [userState, updateUserState] = useContext(UserContext);\r\n\r\n        if (!state.readonly) {\r\n            updateState({\r\n                type: \"UPDATE_READONLY\", \r\n                payload: true\r\n            });\r\n        }\r\n\r\n        let params = useParams();\r\n\r\n        console.log(!userState.userId);\r\n\r\n/*         if (!userState.userId || userState.userId == '') {\r\n            console.log('props.userId');\r\n            return <div className=\"error-message\">Error loading build for edit</div>;\r\n        }  */\r\n    \r\n        console.log('params build id: ' + params.buildId);\r\n        //console.log(PatchList[0]);\r\n\r\n        var root = document.getElementById('root');\r\n        root.dataset.pageName = 'viewBuildPage';\r\n\r\n        if (params.buildId && state.buildId !== params.buildId) {\r\n            loadBuild(params.buildId);\r\n        }\r\n\r\n        function loadBuild(buildId) {\r\n            console.log('loading build id ' + buildId);\r\n            if (state.buildId !== buildId) {\r\n                state.buildId = buildId;\r\n            }\r\n\r\n            db.collection('builds').doc(buildId).get().then((build) => {\r\n                if (!build.data()) {\r\n                    console.log('No build found with ID ' + buildId);\r\n                    return;\r\n                }\r\n\r\n                console.log('build loaded from db:');\r\n                console.log(build.data());\r\n\r\n                updateState({\r\n                    type: 'INIT_STATE_FROM_DATA', \r\n                    payload: build\r\n                });\r\n\r\n                // TODO: Get similar builds and builds from the user for side bar display\r\n                db.collection('builds').where(\"careerId\", \"==\", build.data().careerId).get().then((querySnapshot) => {\r\n                    var similarBuilds = [];\r\n                    querySnapshot.forEach((build) => {\r\n                        if (build.id === buildId) {\r\n                            return;\r\n                        }\r\n                        similarBuilds.push({ id: build.id, data: build.data()});\r\n                    });\r\n\r\n                    console.log('updating similar builds:');\r\n                    console.log(similarBuilds);\r\n                    updateState({\r\n                      type: \"UPDATE_SIMILAR_BUILDS\", \r\n                      payload: similarBuilds\r\n                    }); \r\n                  });\r\n\r\n\r\n            }).catch((error) => {\r\n                console.error('Error retrieving data from DB:', error);\r\n            });\r\n\r\n        }\r\n\r\n        //get build id param\r\n        //if empty, load nothing from DB\r\n        //if not empty, load build from DB and updatestate\r\n\r\n        //saving builds with /create/ url saves new db item and redirects to /buildId/edit page\r\n        //saving builds with /edit/ url just updates the record in the db\r\n\r\n        if (!state.isFromDb) {\r\n            return (\r\n                <div className=\"edit-build-page\" data-readonly={state.readonly} data-dirty={state.dirty}>\r\n                    <p>No build found</p>\r\n                </div>);\r\n        }\r\n\r\n        console.log('build user id: ' + state.userId + ' user context id ' + userState.userId);\r\n        let isAuthor = state.userId === userState.userId;\r\n\r\n        return (\r\n            <div className=\"edit-build-page build-page\" data-author={isAuthor} data-liked={state.isLiked}  data-readonly={state.readonly} data-dirty={state.dirty}>\r\n                <span id=\"buildSaveIndicator\" className=\"border-03 background-18\">Build saved...</span>\r\n                <div className=\"build-left-container\">            \r\n                    <BuildList builds={state.similarBuilds} name=\"Similar Builds\"></BuildList>\r\n                </div>\r\n                <div className=\"build-main-container\">\r\n                    <Tabs>\r\n                        <TabList>\r\n                            <Tab>Summary</Tab>\r\n                            <Tab>Videos</Tab>\r\n                            <Tab>Combos</Tab>                        \r\n                        </TabList>\r\n                        <TabPanel className=\"build-summary-tab\">\r\n                            <div className=\"build-details-container\">\r\n                                <HeroDetails careerId={state.careerId}></HeroDetails>\r\n                                <input type=\"text\" className=\"build-name-input border-02 background-18\" placeholder=\"Name your build\" value={state.name} readOnly></input>\r\n                                <Link to={`/build/${state.buildId}/edit`} className=\"edit-build-button\">edit</Link>\r\n                                <textarea className=\"input-build-description border-02 background-18\" wrap=\"hard\" placeholder=\"Describe your build\" value={state.description} readOnly></textarea>\r\n                                <BuildInformation></BuildInformation>\r\n                                <BuildOptions></BuildOptions>\r\n                            </div>\r\n                            <BuildSummary></BuildSummary>\r\n                        </TabPanel>\r\n                        <TabPanel>\r\n                            <div className=\"build-additional-info\">\r\n                            </div>\r\n                        </TabPanel>\r\n                        <TabPanel>\r\n                            <div className=\"hero-abilities\">\r\n                            </div>                        \r\n                        </TabPanel>\r\n                    </Tabs>\r\n                    <div className=\"build-talents-container\">\r\n                        <HeroTalents contextActionType=\"UPDATE_TALENTS\" careerId={state.careerId} talents={state.talents}></HeroTalents>\r\n                    </div>\r\n                </div>\r\n                <div className=\"build-right-container\">\r\n                    <Inventory></Inventory>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\nexport default ViewBuildPage;"]},"metadata":{},"sourceType":"module"}