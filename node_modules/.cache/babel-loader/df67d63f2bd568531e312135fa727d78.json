{"ast":null,"code":"import _slicedToArray from\"C:\\\\dev\\\\New folder\\\\rg\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useContext}from'react';import HeroTalents from'../heroTalents/HeroTalents';import BuildList from'../buildList/BuildList';import Inventory from'../inventory/Inventory';import'./ViewBuildPage.css';import HeroDetails from'../heroDetails/HeroDetails';import{Tab,Tabs,TabList,TabPanel}from'react-tabs';import\"react-tabs/style/react-tabs.css\";import BuildOptions from'./BuildOptions';import BuildSummary from'./BuildSummary';import{AppContext}from'../../stores/Store';import{useParams}from'react-router';import{db}from'../../utils/Firebase';import{UserContext}from'../../stores/UserStore';import{Link}from'react-router-dom';import BuildInformation from'./BuildInformation';function ViewBuildPage(){var _useContext=useContext(AppContext),_useContext2=_slicedToArray(_useContext,2),state=_useContext2[0],updateState=_useContext2[1];var _useContext3=useContext(UserContext),_useContext4=_slicedToArray(_useContext3,2),userState=_useContext4[0],updateUserState=_useContext4[1];if(!state.readonly){updateState({type:\"UPDATE_READONLY\",payload:true});}var params=useParams();console.log(!userState.userId);/*         if (!userState.userId || userState.userId == '') {\r\n            console.log('props.userId');\r\n            return <div className=\"error-message\">Error loading build for edit</div>;\r\n        }  */console.log('params build id: '+params.buildId);//console.log(PatchList[0]);\nvar root=document.getElementById('root');root.dataset.pageName='viewBuildPage';if(params.buildId&&state.buildId!==params.buildId){loadBuild(params.buildId);}function loadBuild(buildId){console.log('loading build id '+buildId);if(state.buildId!==buildId){state.buildId=buildId;}db.collection('builds').doc(buildId).get().then(function(build){if(!build.data()){console.log('No build found with ID '+buildId);return;}console.log('build loaded from db:');console.log(build.data());updateState({type:'INIT_STATE_FROM_DATA',payload:build});// TODO: Get similar builds and builds from the user for side bar display\ndb.collection('builds').where(\"careerId\",\"==\",build.data().careerId).get().then(function(querySnapshot){var similarBuilds=[];querySnapshot.forEach(function(build){if(build.id===buildId){return;}similarBuilds.push({id:build.id,data:build.data()});});console.log('updating similar builds:');console.log(similarBuilds);updateState({type:\"UPDATE_SIMILAR_BUILDS\",payload:similarBuilds});});}).catch(function(error){console.error('Error retrieving data from DB:',error);});}//get build id param\n//if empty, load nothing from DB\n//if not empty, load build from DB and updatestate\n//saving builds with /create/ url saves new db item and redirects to /buildId/edit page\n//saving builds with /edit/ url just updates the record in the db\nif(!state.isFromDb){return/*#__PURE__*/React.createElement(\"div\",{className:\"edit-build-page\",\"data-readonly\":state.readonly,\"data-dirty\":state.dirty},/*#__PURE__*/React.createElement(\"p\",null,\"No build found\"));}console.log('build user id: '+state.userId+' user context id '+userState.userId);var isAuthor=state.userId===userState.userId;return/*#__PURE__*/React.createElement(\"div\",{className:\"edit-build-page build-page\",\"data-author\":isAuthor,\"data-liked\":state.isLiked,\"data-readonly\":state.readonly,\"data-dirty\":state.dirty},/*#__PURE__*/React.createElement(\"span\",{id:\"buildSaveIndicator\",className:\"border-03 background-18\"},\"Build saved...\"),/*#__PURE__*/React.createElement(\"div\",{className:\"build-left-container\"},/*#__PURE__*/React.createElement(BuildList,{builds:state.similarBuilds,name:\"Similar Builds\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"build-main-container\"},/*#__PURE__*/React.createElement(Tabs,null,/*#__PURE__*/React.createElement(TabList,null,/*#__PURE__*/React.createElement(Tab,null,\"Summary\"),/*#__PURE__*/React.createElement(Tab,null,\"Videos\"),/*#__PURE__*/React.createElement(Tab,null,\"Combos\")),/*#__PURE__*/React.createElement(TabPanel,{className:\"build-summary-tab\"},/*#__PURE__*/React.createElement(\"div\",{className:\"build-details-container\"},/*#__PURE__*/React.createElement(HeroDetails,{careerId:state.careerId}),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",className:\"build-name-input border-02 background-18\",placeholder:\"Name your build\",value:state.name,readOnly:true}),/*#__PURE__*/React.createElement(Link,{to:\"/build/\".concat(state.buildId,\"/edit\"),className:\"edit-build-button\"},\"edit\"),/*#__PURE__*/React.createElement(\"textarea\",{className:\"input-build-description border-02 background-18\",wrap:\"hard\",placeholder:\"Describe your build\",value:state.description,readOnly:true}),/*#__PURE__*/React.createElement(BuildInformation,null),/*#__PURE__*/React.createElement(BuildOptions,null)),/*#__PURE__*/React.createElement(BuildSummary,null)),/*#__PURE__*/React.createElement(TabPanel,null,/*#__PURE__*/React.createElement(\"div\",{className:\"build-additional-info\"})),/*#__PURE__*/React.createElement(TabPanel,null,/*#__PURE__*/React.createElement(\"div\",{className:\"hero-abilities\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"build-talents-container\"},/*#__PURE__*/React.createElement(HeroTalents,{contextActionType:\"UPDATE_TALENTS\",careerId:state.careerId,talents:state.talents}))),/*#__PURE__*/React.createElement(\"div\",{className:\"build-right-container\"},/*#__PURE__*/React.createElement(Inventory,null)));}export default ViewBuildPage;","map":{"version":3,"sources":["C:/dev/New folder/rg/src/components/buildPage/ViewBuildPage.js"],"names":["React","useContext","HeroTalents","BuildList","Inventory","HeroDetails","Tab","Tabs","TabList","TabPanel","BuildOptions","BuildSummary","AppContext","useParams","db","UserContext","Link","BuildInformation","ViewBuildPage","state","updateState","userState","updateUserState","readonly","type","payload","params","console","log","userId","buildId","root","document","getElementById","dataset","pageName","loadBuild","collection","doc","get","then","build","data","where","careerId","querySnapshot","similarBuilds","forEach","id","push","catch","error","isFromDb","dirty","isAuthor","isLiked","name","description","talents"],"mappings":"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","sourcesContent":["import React, {useContext} from 'react';\r\nimport HeroTalents from '../heroTalents/HeroTalents'\r\nimport BuildList from '../buildList/BuildList'\r\nimport Inventory from '../inventory/Inventory'\r\nimport './ViewBuildPage.css';\r\nimport HeroDetails from '../heroDetails/HeroDetails';\r\nimport { Tab, Tabs, TabList, TabPanel } from 'react-tabs';\r\nimport \"react-tabs/style/react-tabs.css\";\r\nimport BuildOptions from './BuildOptions';\r\nimport BuildSummary from './BuildSummary';\r\nimport { AppContext } from '../../stores/Store';\r\nimport { useParams } from 'react-router';\r\nimport { db } from '../../utils/Firebase';\r\nimport { UserContext } from '../../stores/UserStore';\r\nimport { Link } from 'react-router-dom';\r\nimport BuildInformation from './BuildInformation';\r\n\r\nfunction ViewBuildPage() {\r\n\r\n        const [state, updateState] = useContext(AppContext);\r\n        const [userState, updateUserState] = useContext(UserContext);\r\n\r\n        if (!state.readonly) {\r\n            updateState({\r\n                type: \"UPDATE_READONLY\", \r\n                payload: true\r\n            });\r\n        }\r\n\r\n        let params = useParams();\r\n\r\n        console.log(!userState.userId);\r\n\r\n/*         if (!userState.userId || userState.userId == '') {\r\n            console.log('props.userId');\r\n            return <div className=\"error-message\">Error loading build for edit</div>;\r\n        }  */\r\n    \r\n        console.log('params build id: ' + params.buildId);\r\n        //console.log(PatchList[0]);\r\n\r\n        var root = document.getElementById('root');\r\n        root.dataset.pageName = 'viewBuildPage';\r\n\r\n        if (params.buildId && state.buildId !== params.buildId) {\r\n            loadBuild(params.buildId);\r\n        }\r\n\r\n        function loadBuild(buildId) {\r\n            console.log('loading build id ' + buildId);\r\n            if (state.buildId !== buildId) {\r\n                state.buildId = buildId;\r\n            }\r\n\r\n            db.collection('builds').doc(buildId).get().then((build) => {\r\n                if (!build.data()) {\r\n                    console.log('No build found with ID ' + buildId);\r\n                    return;\r\n                }\r\n\r\n                console.log('build loaded from db:');\r\n                console.log(build.data());\r\n\r\n                updateState({\r\n                    type: 'INIT_STATE_FROM_DATA', \r\n                    payload: build\r\n                });\r\n\r\n                // TODO: Get similar builds and builds from the user for side bar display\r\n                db.collection('builds').where(\"careerId\", \"==\", build.data().careerId).get().then((querySnapshot) => {\r\n                    var similarBuilds = [];\r\n                    querySnapshot.forEach((build) => {\r\n                        if (build.id === buildId) {\r\n                            return;\r\n                        }\r\n                        similarBuilds.push({ id: build.id, data: build.data()});\r\n                    });\r\n\r\n                    console.log('updating similar builds:');\r\n                    console.log(similarBuilds);\r\n                    updateState({\r\n                      type: \"UPDATE_SIMILAR_BUILDS\", \r\n                      payload: similarBuilds\r\n                    }); \r\n                  });\r\n\r\n\r\n            }).catch((error) => {\r\n                console.error('Error retrieving data from DB:', error);\r\n            });\r\n\r\n        }\r\n\r\n        //get build id param\r\n        //if empty, load nothing from DB\r\n        //if not empty, load build from DB and updatestate\r\n\r\n        //saving builds with /create/ url saves new db item and redirects to /buildId/edit page\r\n        //saving builds with /edit/ url just updates the record in the db\r\n\r\n        if (!state.isFromDb) {\r\n            return (\r\n                <div className=\"edit-build-page\" data-readonly={state.readonly} data-dirty={state.dirty}>\r\n                    <p>No build found</p>\r\n                </div>);\r\n        }\r\n\r\n        console.log('build user id: ' + state.userId + ' user context id ' + userState.userId);\r\n        let isAuthor = state.userId === userState.userId;\r\n\r\n        return (\r\n            <div className=\"edit-build-page build-page\" data-author={isAuthor} data-liked={state.isLiked}  data-readonly={state.readonly} data-dirty={state.dirty}>\r\n                <span id=\"buildSaveIndicator\" className=\"border-03 background-18\">Build saved...</span>\r\n                <div className=\"build-left-container\">            \r\n                    <BuildList builds={state.similarBuilds} name=\"Similar Builds\"></BuildList>\r\n                </div>\r\n                <div className=\"build-main-container\">\r\n                    <Tabs>\r\n                        <TabList>\r\n                            <Tab>Summary</Tab>\r\n                            <Tab>Videos</Tab>\r\n                            <Tab>Combos</Tab>                        \r\n                        </TabList>\r\n                        <TabPanel className=\"build-summary-tab\">\r\n                            <div className=\"build-details-container\">\r\n                                <HeroDetails careerId={state.careerId}></HeroDetails>\r\n                                <input type=\"text\" className=\"build-name-input border-02 background-18\" placeholder=\"Name your build\" value={state.name} readOnly></input>\r\n                                <Link to={`/build/${state.buildId}/edit`} className=\"edit-build-button\">edit</Link>\r\n                                <textarea className=\"input-build-description border-02 background-18\" wrap=\"hard\" placeholder=\"Describe your build\" value={state.description} readOnly></textarea>\r\n                                <BuildInformation></BuildInformation>\r\n                                <BuildOptions></BuildOptions>\r\n                            </div>\r\n                            <BuildSummary></BuildSummary>\r\n                        </TabPanel>\r\n                        <TabPanel>\r\n                            <div className=\"build-additional-info\">\r\n                            </div>\r\n                        </TabPanel>\r\n                        <TabPanel>\r\n                            <div className=\"hero-abilities\">\r\n                            </div>                        \r\n                        </TabPanel>\r\n                    </Tabs>\r\n                    <div className=\"build-talents-container\">\r\n                        <HeroTalents contextActionType=\"UPDATE_TALENTS\" careerId={state.careerId} talents={state.talents}></HeroTalents>\r\n                    </div>\r\n                </div>\r\n                <div className=\"build-right-container\">\r\n                    <Inventory></Inventory>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\nexport default ViewBuildPage;"]},"metadata":{},"sourceType":"module"}